2018-02-09 13:37:41.253 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-09 13:37:41.338 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-09 13:37:41.342 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-09 13:37:41.346 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-09 13:37:41.349 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-09 13:38:20.503 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 13:38:21.589 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:38:21.604 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:38:21.729 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 13:38:21.778 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 13:38:21.785 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 13:38:21.801 -05:00 [DBG] Start discovery request
2018-02-09 13:38:23.306 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 13:38:23.535 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-09 13:38:23.635 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-09 13:38:23.640 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-09 13:38:23.658 -05:00 [DBG] Start authorize request
2018-02-09 13:38:23.687 -05:00 [DBG] No user present in authorize request
2018-02-09 13:38:23.714 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 13:38:24.970 -05:00 [DBG] js found in database: true
2018-02-09 13:38:25.192 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:38:25.629 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:38:25.797 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:38:26.099 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:38:26.136 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 13:38:26.200 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "2e1163f138514b2ab6d9b3da5cca4a03",
  "Nonce": "d5a791d91e664b28a021b589307cc6a9",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "2e1163f138514b2ab6d9b3da5cca4a03",
    "nonce": "d5a791d91e664b28a021b589307cc6a9"
  }
}
2018-02-09 13:38:26.232 -05:00 [INF] Showing login: User is not authenticated
2018-02-09 13:38:26.881 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 13:38:26.913 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 13:38:27.728 -05:00 [DBG] js found in database: true
2018-02-09 13:38:27.883 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:38:28.250 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:38:28.408 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:38:28.788 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:38:28.796 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 13:38:57.996 -05:00 [DBG] Augmenting SignInContext
2018-02-09 13:38:58.004 -05:00 [DBG] Adding idp claim with value: local
2018-02-09 13:38:58.008 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-09 13:38:58.016 -05:00 [DBG] Adding auth_time claim with value: 1518201538
2018-02-09 13:38:58.040 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 13:38:58.049 -05:00 [INF] User logged in.
2018-02-09 13:38:58.109 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:38:58.119 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:38:58.129 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-09 13:38:58.136 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-09 13:38:58.143 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-09 13:38:58.163 -05:00 [DBG] Start authorize callback request
2018-02-09 13:38:58.179 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 13:38:58.184 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 13:38:59.378 -05:00 [DBG] js found in database: true
2018-02-09 13:38:59.598 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:39:00.165 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:39:00.406 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:39:01.020 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:39:01.032 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 13:39:01.037 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "2e1163f138514b2ab6d9b3da5cca4a03",
  "Nonce": "d5a791d91e664b28a021b589307cc6a9",
  "SessionId": "f80b09fa34fe67f90117912fb01ee854",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "2e1163f138514b2ab6d9b3da5cca4a03",
    "nonce": "d5a791d91e664b28a021b589307cc6a9"
  }
}
2018-02-09 13:39:01.263 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-09 13:39:01.284 -05:00 [DBG] Creating Implicit Flow response.
2018-02-09 13:39:01.311 -05:00 [DBG] Getting claims for access token for client: js
2018-02-09 13:39:01.317 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 13:39:01.722 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-09 13:39:01.729 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-09 13:39:01.775 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "2e1163f138514b2ab6d9b3da5cca4a03",
  "Scope": "openid profile api1"
}
2018-02-09 13:39:01.824 -05:00 [DBG] Augmenting SignInContext
2018-02-09 13:39:01.829 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 13:39:02.256 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 13:39:02.334 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:39:02.340 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:39:02.362 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 13:39:02.372 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 13:39:02.392 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 13:39:02.416 -05:00 [DBG] Start discovery request
2018-02-09 13:39:02.852 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 13:39:02.879 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-09 13:39:02.934 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:39:02.940 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:39:02.950 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 13:39:02.957 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 13:39:02.962 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 13:39:02.980 -05:00 [DBG] Start key discovery request
2018-02-09 13:39:03.093 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 13:39:03.148 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:39:03.154 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:39:03.192 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 13:39:03.250 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:39:03.257 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:39:03.273 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-09 13:39:03.289 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-09 13:39:03.296 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-09 13:39:03.318 -05:00 [DBG] Start userinfo request
2018-02-09 13:39:03.330 -05:00 [DBG] Bearer token found in header
2018-02-09 13:39:04.059 -05:00 [DBG] js found in database: true
2018-02-09 13:39:04.621 -05:00 [DBG] js found in database: true
2018-02-09 13:39:04.702 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 13:39:04.722 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518201541,
    "exp": 1518205141,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518201538,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-09 13:39:04.745 -05:00 [DBG] Creating userinfo response
2018-02-09 13:39:04.761 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 13:39:04.773 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 13:39:04.896 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:39:04.905 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-09 13:39:04.911 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 13:39:05.006 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:39:05.139 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-09 13:39:05.149 -05:00 [DBG] End userinfo request
2018-02-09 13:39:05.200 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:39:05.217 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:39:05.228 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 13:39:05.237 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 13:39:05.244 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 13:39:05.255 -05:00 [DBG] Rendering check session result
2018-02-09 13:39:05.538 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 13:39:05.608 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:39:05.613 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:39:05.624 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 13:39:05.632 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 13:39:05.637 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 13:39:05.646 -05:00 [DBG] Start discovery request
2018-02-09 13:39:06.042 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 13:39:06.082 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:39:06.092 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:39:06.102 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 13:39:06.108 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 13:39:06.114 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 13:39:06.125 -05:00 [DBG] Rendering check session result
2018-02-09 13:39:13.278 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 13:39:13.284 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 13:39:13.290 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 13:39:13.298 -05:00 [DBG] Start discovery request
2018-02-09 13:39:13.703 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 13:39:14.217 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 13:39:14.223 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 13:39:14.229 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 13:39:14.238 -05:00 [DBG] Start key discovery request
2018-02-09 14:08:05.810 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-09 14:08:05.893 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-09 14:08:05.897 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-09 14:08:05.901 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-09 14:08:05.905 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-09 14:12:44.786 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:12:44.838 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:12:44.844 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:12:44.860 -05:00 [DBG] Start discovery request
2018-02-09 14:12:47.228 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:12:48.002 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:12:48.084 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:12:48.089 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:12:48.104 -05:00 [DBG] Start key discovery request
2018-02-09 14:12:48.391 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-09 14:12:48.418 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-09 14:12:48.425 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-09 14:12:48.447 -05:00 [DBG] Start authorize request
2018-02-09 14:12:48.480 -05:00 [DBG] No user present in authorize request
2018-02-09 14:12:48.498 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:12:49.678 -05:00 [DBG] mvc found in database: true
2018-02-09 14:12:49.697 -05:00 [DBG] Checking for PKCE parameters
2018-02-09 14:12:49.704 -05:00 [DBG] No PKCE used.
2018-02-09 14:12:49.906 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:12:50.265 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:12:50.420 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:12:50.733 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:12:50.763 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:12:50.806 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1.APIScope",
  "State": "CfDJ8O7BMrsJqQNKq-OZZwepkQ1JjDcHR3R2KHS9rDrZMkQRDodAlhaHHcZOdx1-txgwp8wYpvsR4N2NtQUd1vwQiudVSinP7ZZ6yB-J2iZ6y4hgEk0QYBBHterxxx68P8b_Jy3XxxrTG2jl-iFbJkS6_sOPk1RBqhEooUFdVq3EnfROkj0ZgefHGrqjZi1xfmWMzEDUdD1uEm5ddv2BuWUbq0TByZYx73ev_Df-xIOIibE6NfNUc1BsNjntDU-Gvc9qXqDIQ7oTarBkQD6Y1DU-44NN25ZxU_qtcz0NSshgY35IYuJO2wiaykpHUaJt_eN22D0jLwTitv4fKlo35O76azI",
  "Nonce": "636538003682779179.ODA4MmY3MDctYmE4Zi00NWY4LTk0MmEtNWZmMDZiOTdkMWEyZjU2NjViMGEtOTM2Yy00ZmYyLWExNjEtNjZmYWNiMTU1ZDFm",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1.APIScope",
    "response_mode": "form_post",
    "nonce": "636538003682779179.ODA4MmY3MDctYmE4Zi00NWY4LTk0MmEtNWZmMDZiOTdkMWEyZjU2NjViMGEtOTM2Yy00ZmYyLWExNjEtNjZmYWNiMTU1ZDFm",
    "state": "CfDJ8O7BMrsJqQNKq-OZZwepkQ1JjDcHR3R2KHS9rDrZMkQRDodAlhaHHcZOdx1-txgwp8wYpvsR4N2NtQUd1vwQiudVSinP7ZZ6yB-J2iZ6y4hgEk0QYBBHterxxx68P8b_Jy3XxxrTG2jl-iFbJkS6_sOPk1RBqhEooUFdVq3EnfROkj0ZgefHGrqjZi1xfmWMzEDUdD1uEm5ddv2BuWUbq0TByZYx73ev_Df-xIOIibE6NfNUc1BsNjntDU-Gvc9qXqDIQ7oTarBkQD6Y1DU-44NN25ZxU_qtcz0NSshgY35IYuJO2wiaykpHUaJt_eN22D0jLwTitv4fKlo35O76azI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-02-09 14:12:50.845 -05:00 [INF] Showing login: User is not authenticated
2018-02-09 14:12:51.430 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 14:12:51.469 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:12:52.182 -05:00 [DBG] mvc found in database: true
2018-02-09 14:12:52.190 -05:00 [DBG] Checking for PKCE parameters
2018-02-09 14:12:52.195 -05:00 [DBG] No PKCE used.
2018-02-09 14:12:52.336 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:12:52.695 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:12:52.843 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:12:53.204 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:12:53.212 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:13:26.976 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:13:26.985 -05:00 [DBG] Adding idp claim with value: local
2018-02-09 14:13:26.990 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-09 14:13:26.995 -05:00 [DBG] Adding auth_time claim with value: 1518203606
2018-02-09 14:13:27.021 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:13:27.036 -05:00 [INF] User logged in.
2018-02-09 14:13:27.096 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:13:27.105 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:13:27.114 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-09 14:13:27.123 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-09 14:13:27.128 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-09 14:13:27.147 -05:00 [DBG] Start authorize callback request
2018-02-09 14:13:27.160 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:13:27.165 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:13:28.306 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:28.315 -05:00 [DBG] Checking for PKCE parameters
2018-02-09 14:13:28.319 -05:00 [DBG] No PKCE used.
2018-02-09 14:13:28.558 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:29.130 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:29.357 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:29.913 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:29.923 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:13:29.930 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1.APIScope",
  "State": "CfDJ8O7BMrsJqQNKq-OZZwepkQ1JjDcHR3R2KHS9rDrZMkQRDodAlhaHHcZOdx1-txgwp8wYpvsR4N2NtQUd1vwQiudVSinP7ZZ6yB-J2iZ6y4hgEk0QYBBHterxxx68P8b_Jy3XxxrTG2jl-iFbJkS6_sOPk1RBqhEooUFdVq3EnfROkj0ZgefHGrqjZi1xfmWMzEDUdD1uEm5ddv2BuWUbq0TByZYx73ev_Df-xIOIibE6NfNUc1BsNjntDU-Gvc9qXqDIQ7oTarBkQD6Y1DU-44NN25ZxU_qtcz0NSshgY35IYuJO2wiaykpHUaJt_eN22D0jLwTitv4fKlo35O76azI",
  "Nonce": "636538003682779179.ODA4MmY3MDctYmE4Zi00NWY4LTk0MmEtNWZmMDZiOTdkMWEyZjU2NjViMGEtOTM2Yy00ZmYyLWExNjEtNjZmYWNiMTU1ZDFm",
  "SessionId": "1d6041be80178d5e08717d748507a54d",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1.APIScope",
    "response_mode": "form_post",
    "nonce": "636538003682779179.ODA4MmY3MDctYmE4Zi00NWY4LTk0MmEtNWZmMDZiOTdkMWEyZjU2NjViMGEtOTM2Yy00ZmYyLWExNjEtNjZmYWNiMTU1ZDFm",
    "state": "CfDJ8O7BMrsJqQNKq-OZZwepkQ1JjDcHR3R2KHS9rDrZMkQRDodAlhaHHcZOdx1-txgwp8wYpvsR4N2NtQUd1vwQiudVSinP7ZZ6yB-J2iZ6y4hgEk0QYBBHterxxx68P8b_Jy3XxxrTG2jl-iFbJkS6_sOPk1RBqhEooUFdVq3EnfROkj0ZgefHGrqjZi1xfmWMzEDUdD1uEm5ddv2BuWUbq0TByZYx73ev_Df-xIOIibE6NfNUc1BsNjntDU-Gvc9qXqDIQ7oTarBkQD6Y1DU-44NN25ZxU_qtcz0NSshgY35IYuJO2wiaykpHUaJt_eN22D0jLwTitv4fKlo35O76azI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-02-09 14:13:30.172 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-09 14:13:30.188 -05:00 [DBG] Creating Hybrid Flow response.
2018-02-09 14:13:30.376 -05:00 [DBG] OOucvgG30xymJopJb1uz2p5UOL6hQiNvi58FB0r6lOQ= not found in database
2018-02-09 14:13:30.529 -05:00 [DBG] Creating Implicit Flow response.
2018-02-09 14:13:30.558 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: mvc
2018-02-09 14:13:30.913 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8O7BMrsJqQNKq-OZZwepkQ1JjDcHR3R2KHS9rDrZMkQRDodAlhaHHcZOdx1-txgwp8wYpvsR4N2NtQUd1vwQiudVSinP7ZZ6yB-J2iZ6y4hgEk0QYBBHterxxx68P8b_Jy3XxxrTG2jl-iFbJkS6_sOPk1RBqhEooUFdVq3EnfROkj0ZgefHGrqjZi1xfmWMzEDUdD1uEm5ddv2BuWUbq0TByZYx73ev_Df-xIOIibE6NfNUc1BsNjntDU-Gvc9qXqDIQ7oTarBkQD6Y1DU-44NN25ZxU_qtcz0NSshgY35IYuJO2wiaykpHUaJt_eN22D0jLwTitv4fKlo35O76azI",
  "Scope": "openid profile api1.APIScope"
}
2018-02-09 14:13:30.968 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:13:30.974 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:13:31.310 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-02-09 14:13:31.327 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-02-09 14:13:31.333 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-02-09 14:13:31.365 -05:00 [DBG] Start token request.
2018-02-09 14:13:31.389 -05:00 [DBG] Start client validation
2018-02-09 14:13:31.405 -05:00 [DBG] Start parsing Basic Authentication secret
2018-02-09 14:13:31.416 -05:00 [DBG] Start parsing for secret in post body
2018-02-09 14:13:31.422 -05:00 [DBG] Parser found secret: PostBodySecretParser
2018-02-09 14:13:31.427 -05:00 [DBG] Secret id found: mvc
2018-02-09 14:13:32.078 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:32.102 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-02-09 14:13:32.107 -05:00 [DBG] Client validation success
2018-02-09 14:13:32.124 -05:00 [DBG] Start token request validation
2018-02-09 14:13:32.155 -05:00 [DBG] Start validation of authorization code token request
2018-02-09 14:13:32.272 -05:00 [DBG] OOucvgG30xymJopJb1uz2p5UOL6hQiNvi58FB0r6lOQ= found in database: true
2018-02-09 14:13:32.410 -05:00 [DBG] removing OOucvgG30xymJopJb1uz2p5UOL6hQiNvi58FB0r6lOQ= persisted grant from database
2018-02-09 14:13:32.565 -05:00 [DBG] Validation of authorization code token request success
2018-02-09 14:13:32.589 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "4d782b720d311e9feb3cd45f218974993cdd11b80e2bec7499dba7a60bece90e",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "4d782b720d311e9feb3cd45f218974993cdd11b80e2bec7499dba7a60bece90e",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-02-09 14:13:33.470 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:33.633 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:34.037 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:34.073 -05:00 [DBG] Getting claims for access token for client: mvc
2018-02-09 14:13:34.079 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:13:35.070 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:35.235 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:35.648 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:35.657 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: mvc
2018-02-09 14:13:35.834 -05:00 [DBG] Token request success.
2018-02-09 14:13:35.951 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-09 14:13:35.961 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-09 14:13:35.966 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-09 14:13:35.987 -05:00 [DBG] Start userinfo request
2018-02-09 14:13:35.997 -05:00 [DBG] Bearer token found in header
2018-02-09 14:13:36.728 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:37.295 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:37.381 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 14:13:37.397 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518203614,
    "exp": 1518207214,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518203606,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1.APIScope"
    ],
    "amr": "pwd"
  }
}
2018-02-09 14:13:37.422 -05:00 [DBG] Creating userinfo response
2018-02-09 14:13:37.434 -05:00 [DBG] Scopes in access token: openid profile api1.APIScope
2018-02-09 14:13:37.446 -05:00 [DBG] Scopes in access token: openid profile api1.APIScope
2018-02-09 14:13:37.625 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:37.638 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-09 14:13:37.643 -05:00 [DBG] Scopes in access token: openid profile api1.APIScope
2018-02-09 14:13:37.795 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:37.963 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-09 14:13:37.975 -05:00 [DBG] End userinfo request
2018-02-09 14:13:43.781 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:13:43.788 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:13:43.795 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:13:43.806 -05:00 [DBG] Start discovery request
2018-02-09 14:13:44.202 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:13:44.707 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:13:44.715 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:13:44.722 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:13:44.732 -05:00 [DBG] Start key discovery request
2018-02-09 14:13:56.236 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:13:56.243 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:13:56.249 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:13:56.258 -05:00 [DBG] Start discovery request
2018-02-09 14:13:56.642 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:13:56.749 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:13:56.757 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:13:56.763 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:13:56.775 -05:00 [DBG] Start key discovery request
2018-02-09 14:13:56.920 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-02-09 14:13:56.927 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-02-09 14:13:56.934 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-02-09 14:13:56.963 -05:00 [DBG] Start token request.
2018-02-09 14:13:56.969 -05:00 [DBG] Start client validation
2018-02-09 14:13:56.975 -05:00 [DBG] Start parsing Basic Authentication secret
2018-02-09 14:13:56.981 -05:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-02-09 14:13:56.990 -05:00 [DBG] Secret id found: mvc
2018-02-09 14:13:57.569 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:57.577 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-02-09 14:13:57.583 -05:00 [DBG] Client validation success
2018-02-09 14:13:57.590 -05:00 [DBG] Start token request validation
2018-02-09 14:13:57.614 -05:00 [DBG] Start client credentials token request validation
2018-02-09 14:13:57.690 -05:00 [DBG] Found [] identity scopes in database
2018-02-09 14:13:57.993 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:58.066 -05:00 [DBG] Found [] identity scopes in database
2018-02-09 14:13:58.356 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:58.367 -05:00 [DBG] mvc credentials token request validation success
2018-02-09 14:13:58.374 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "GrantType": "client_credentials",
  "Scopes": "api1.APIScope",
  "Raw": {
    "grant_type": "client_credentials",
    "scope": "api1.APIScope"
  }
}
2018-02-09 14:13:58.392 -05:00 [DBG] Getting claims for access token for client: mvc
2018-02-09 14:13:58.404 -05:00 [DBG] Token request success.
2018-02-09 14:14:04.333 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:14:04.354 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:14:04.365 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-09 14:14:04.378 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-09 14:14:04.386 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-09 14:14:04.410 -05:00 [DBG] Processing signout request for 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:14:04.433 -05:00 [DBG] Start end session request validation
2018-02-09 14:14:04.454 -05:00 [DBG] Start identity token validation
2018-02-09 14:14:05.028 -05:00 [DBG] mvc found in database: true
2018-02-09 14:14:05.035 -05:00 [DBG] Client found: mvc / mvc.client
2018-02-09 14:14:05.116 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 14:14:05.126 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1518203615,
    "exp": 1518203915,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636538003682779179.ODA4MmY3MDctYmE4Zi00NWY4LTk0MmEtNWZmMDZiOTdkMWEyZjU2NjViMGEtOTM2Yy00ZmYyLWExNjEtNjZmYWNiMTU1ZDFm",
    "iat": 1518203615,
    "at_hash": "l2SF4-QjHaKuQNEXwu7Lxg",
    "sid": "1d6041be80178d5e08717d748507a54d",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518203606,
    "idp": "local",
    "preferred_username": "prdiet",
    "name": "prdiet",
    "amr": "pwd"
  }
}
2018-02-09 14:14:05.146 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8O7BMrsJqQNKq-OZZwepkQ2qEA49mbJuh6b0ABdfYXv0bLDGdGybfwc5HTLcREXUIWi5zUn3yhX10LrwHZmouTT2-yxyj6wCxrfAksxZ6XuNg7r-CSa4kDrA_Tb9hb_DScdkiwV565e639GEb1M4YPEFF7znmtPogfwNa1CBg-vu",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjY3NTYzMGI1NWQ3NWE3OTI4MmNmZWI2OGNiN2I2MDZmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTgyMDM2MTUsImV4cCI6MTUxODIwMzkxNSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1MzgwMDM2ODI3NzkxNzkuT0RBNE1tWTNNRGN0WW1FNFppMDBOV1k0TFRrME1tRXROV1ptTURaaU9UZGtNV0V5WmpVMk5qVmlNR0V0T1RNMll5MDBabVl5TFdFeE5qRXROalptWVdOaU1UVTFaREZtIiwiaWF0IjoxNTE4MjAzNjE1LCJhdF9oYXNoIjoibDJTRjQtUWpIYUt1UU5FWHd1N0x4ZyIsInNpZCI6IjFkNjA0MWJlODAxNzhkNWUwODcxN2Q3NDg1MDdhNTRkIiwic3ViIjoiOGFlMjRhMjgtNTlmNS00OGE2LTkyYzYtYzZjYWM1NTEzNDFiIiwiYXV0aF90aW1lIjoxNTE4MjAzNjA2LCJpZHAiOiJsb2NhbCIsInByZWZlcnJlZF91c2VybmFtZSI6InByZGlldCIsIm5hbWUiOiJwcmRpZXQiLCJhbXIiOlsicHdkIl19.ZRbjbnnBJtmHv_JimyGFBq9iRH9hpWTAuFbAhIySc9lW3eSuuty7dIVMgsW2om-Cpi0mfJ3uAEYUSByj9qqwgSUXKv2GLH8FxGUXzOzZ4fGI1v9jRUeyZ0w_878iCIafKZDIiUV3vrGevoc2d7cgOAAHWLG9KLU9eN2P1Dl_FYkB7irTKhgPu3wEo-zI4KHSyWjHMqDyTr2jLh6TLK7XQ0CmHIPLTbld8bSxKgVy51y3KP3Bh-lJIySv17rYYUAQIwK7KvXKfYMIg33zG3PEs-kXzLSaCei0M3vB4hJisyjUKMMZYGku41jDxSJQ7jNN6lETOBfKBzxLAAzhKYLMpg",
    "state": "CfDJ8O7BMrsJqQNKq-OZZwepkQ2qEA49mbJuh6b0ABdfYXv0bLDGdGybfwc5HTLcREXUIWi5zUn3yhX10LrwHZmouTT2-yxyj6wCxrfAksxZ6XuNg7r-CSa4kDrA_Tb9hb_DScdkiwV565e639GEb1M4YPEFF7znmtPogfwNa1CBg-vu",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-02-09 14:14:05.168 -05:00 [DBG] Success validating end session request from mvc
2018-02-09 14:14:05.235 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:14:05.246 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:14:05.464 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-02-09 14:14:05.474 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 14:14:05.485 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-02-09 14:14:05.497 -05:00 [INF] User logged out.
2018-02-09 14:14:05.954 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-09 14:14:05.970 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-09 14:14:05.977 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-09 14:14:05.998 -05:00 [DBG] Processing signout callback request
2018-02-09 14:14:06.640 -05:00 [DBG] mvc found in database: true
2018-02-09 14:14:06.648 -05:00 [DBG] Client front-channel logout URLs: http://localhost:5002/signout-oidc?sid=1d6041be80178d5e08717d748507a54d&iss=http%3A%2F%2Flocalhost%3A5000
2018-02-09 14:14:06.656 -05:00 [DBG] No client back-channel logout URLs
2018-02-09 14:14:06.661 -05:00 [INF] Successful signout callback.
2018-02-09 14:14:06.672 -05:00 [DBG] Client front-channel iframe urls: ["http://localhost:5002/signout-oidc?sid=1d6041be80178d5e08717d748507a54d&iss=http%3A%2F%2Flocalhost%3A5000"]
2018-02-09 14:14:06.678 -05:00 [DBG] No client back-channel iframe urls
2018-02-09 14:15:50.763 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-09 14:15:50.854 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-09 14:15:50.859 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-09 14:15:50.863 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-09 14:15:50.867 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-09 14:17:18.827 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:17:20.110 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:17:20.125 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:17:20.289 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:17:20.341 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:17:20.347 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:17:20.365 -05:00 [DBG] Start discovery request
2018-02-09 14:17:22.170 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:17:22.456 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-09 14:17:22.569 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-09 14:17:22.576 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-09 14:17:22.595 -05:00 [DBG] Start authorize request
2018-02-09 14:17:22.633 -05:00 [DBG] No user present in authorize request
2018-02-09 14:17:22.665 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:17:24.036 -05:00 [DBG] js found in database: true
2018-02-09 14:17:24.282 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:17:24.736 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:17:24.895 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:17:25.225 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:17:25.258 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:17:25.330 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "0aa761d555a247469fe4cfbe3f981b46",
  "Nonce": "233614a0659f4797bdccf4783de5c187",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "0aa761d555a247469fe4cfbe3f981b46",
    "nonce": "233614a0659f4797bdccf4783de5c187"
  }
}
2018-02-09 14:17:25.362 -05:00 [INF] Showing login: User is not authenticated
2018-02-09 14:17:26.047 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 14:17:26.083 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:17:26.926 -05:00 [DBG] js found in database: true
2018-02-09 14:17:27.111 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:17:27.541 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:17:27.738 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:17:28.143 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:17:28.154 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:18:01.664 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:18:01.674 -05:00 [DBG] Adding idp claim with value: local
2018-02-09 14:18:01.679 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-09 14:18:01.685 -05:00 [DBG] Adding auth_time claim with value: 1518203881
2018-02-09 14:18:01.713 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:18:01.726 -05:00 [INF] User logged in.
2018-02-09 14:18:01.793 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:01.803 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:01.813 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-09 14:18:01.821 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-09 14:18:01.826 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-09 14:18:01.850 -05:00 [DBG] Start authorize callback request
2018-02-09 14:18:01.864 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:18:01.868 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:18:03.171 -05:00 [DBG] js found in database: true
2018-02-09 14:18:03.438 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:18:04.080 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:18:04.329 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:18:04.999 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:18:05.011 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:18:05.021 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "0aa761d555a247469fe4cfbe3f981b46",
  "Nonce": "233614a0659f4797bdccf4783de5c187",
  "SessionId": "cd0b28a8e8d9751c79dfd5bd98a0d4d4",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "0aa761d555a247469fe4cfbe3f981b46",
    "nonce": "233614a0659f4797bdccf4783de5c187"
  }
}
2018-02-09 14:18:05.263 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-09 14:18:05.284 -05:00 [DBG] Creating Implicit Flow response.
2018-02-09 14:18:05.317 -05:00 [DBG] Getting claims for access token for client: js
2018-02-09 14:18:05.323 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:18:05.714 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-09 14:18:05.720 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-09 14:18:05.769 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "0aa761d555a247469fe4cfbe3f981b46",
  "Scope": "openid profile api1"
}
2018-02-09 14:18:05.815 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:18:05.820 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:18:06.276 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:18:06.353 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:18:06.365 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:18:06.383 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:18:06.392 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:18:06.403 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:18:06.417 -05:00 [DBG] Start discovery request
2018-02-09 14:18:06.858 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:18:06.888 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-09 14:18:06.951 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:18:06.961 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:18:06.976 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:18:06.986 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:18:06.993 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:18:07.009 -05:00 [DBG] Start key discovery request
2018-02-09 14:18:07.117 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 14:18:07.187 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:18:07.195 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:18:07.231 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 14:18:07.290 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:18:07.297 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:18:07.312 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-09 14:18:07.328 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-09 14:18:07.334 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-09 14:18:07.360 -05:00 [DBG] Start userinfo request
2018-02-09 14:18:07.374 -05:00 [DBG] Bearer token found in header
2018-02-09 14:18:08.195 -05:00 [DBG] js found in database: true
2018-02-09 14:18:08.812 -05:00 [DBG] js found in database: true
2018-02-09 14:18:08.916 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 14:18:08.939 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518203885,
    "exp": 1518207485,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518203881,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-09 14:18:08.968 -05:00 [DBG] Creating userinfo response
2018-02-09 14:18:08.982 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:18:08.995 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:18:09.189 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:18:09.199 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-09 14:18:09.204 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:18:09.388 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:18:09.576 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-09 14:18:09.586 -05:00 [DBG] End userinfo request
2018-02-09 14:18:09.630 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:09.646 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:09.672 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 14:18:09.681 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 14:18:09.687 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 14:18:09.703 -05:00 [DBG] Rendering check session result
2018-02-09 14:18:10.030 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:18:10.102 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:18:10.110 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:18:10.124 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:18:10.131 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:18:10.138 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:18:10.148 -05:00 [DBG] Start discovery request
2018-02-09 14:18:10.573 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:18:10.605 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:10.615 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:10.625 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 14:18:10.631 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 14:18:10.637 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 14:18:10.648 -05:00 [DBG] Rendering check session result
2018-02-09 14:18:14.018 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:18:14.024 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:18:14.032 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:18:14.041 -05:00 [DBG] Start discovery request
2018-02-09 14:18:14.457 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:18:15.000 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:18:15.007 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:18:15.016 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:18:15.026 -05:00 [DBG] Start key discovery request
2018-02-09 14:48:26.223 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-09 14:48:26.308 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-09 14:48:26.313 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-09 14:48:26.317 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-09 14:48:26.340 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-09 14:50:17.060 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:50:18.409 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:18.429 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:18.588 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:50:18.637 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:50:18.644 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:50:18.664 -05:00 [DBG] Start discovery request
2018-02-09 14:50:20.380 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:50:20.710 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-09 14:50:20.799 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-09 14:50:20.806 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-09 14:50:20.826 -05:00 [DBG] Start authorize request
2018-02-09 14:50:20.859 -05:00 [DBG] No user present in authorize request
2018-02-09 14:50:20.892 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:50:22.279 -05:00 [DBG] js found in database: true
2018-02-09 14:50:22.525 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:22.973 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:23.164 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:23.475 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:23.515 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:50:23.587 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "4d85185915de4a0abfaece08e5199861",
  "Nonce": "c6f1ff10d2af4f95904af564b628567f",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "4d85185915de4a0abfaece08e5199861",
    "nonce": "c6f1ff10d2af4f95904af564b628567f"
  }
}
2018-02-09 14:50:23.620 -05:00 [INF] Showing login: User is not authenticated
2018-02-09 14:50:24.354 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 14:50:24.401 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:50:25.344 -05:00 [DBG] js found in database: true
2018-02-09 14:50:25.507 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:25.924 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:26.074 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:26.494 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:26.506 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:50:52.106 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:50:52.115 -05:00 [DBG] Adding idp claim with value: local
2018-02-09 14:50:52.119 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-09 14:50:52.125 -05:00 [DBG] Adding auth_time claim with value: 1518205852
2018-02-09 14:50:52.153 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:50:52.168 -05:00 [INF] User logged in.
2018-02-09 14:50:52.249 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:50:52.258 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:50:52.268 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-09 14:50:52.275 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-09 14:50:52.280 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-09 14:50:52.301 -05:00 [DBG] Start authorize callback request
2018-02-09 14:50:52.315 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:50:52.320 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:50:53.490 -05:00 [DBG] js found in database: true
2018-02-09 14:50:53.731 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:54.293 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:54.521 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:55.094 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:55.105 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:50:55.112 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "4d85185915de4a0abfaece08e5199861",
  "Nonce": "c6f1ff10d2af4f95904af564b628567f",
  "SessionId": "b9575fbc8364c825a4d62644f098c849",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "4d85185915de4a0abfaece08e5199861",
    "nonce": "c6f1ff10d2af4f95904af564b628567f"
  }
}
2018-02-09 14:50:55.331 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-09 14:50:55.349 -05:00 [DBG] Creating Implicit Flow response.
2018-02-09 14:50:55.374 -05:00 [DBG] Getting claims for access token for client: js
2018-02-09 14:50:55.379 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:50:55.779 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-09 14:50:55.786 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-09 14:50:55.826 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "4d85185915de4a0abfaece08e5199861",
  "Scope": "openid profile api1"
}
2018-02-09 14:50:55.879 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:50:55.885 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:50:56.242 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:50:56.320 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:56.328 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:56.348 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:50:56.355 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:50:56.362 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:50:56.374 -05:00 [DBG] Start discovery request
2018-02-09 14:50:56.776 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:50:56.805 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-09 14:50:56.859 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:56.865 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:56.878 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:50:56.887 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:50:56.894 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:50:56.920 -05:00 [DBG] Start key discovery request
2018-02-09 14:50:57.001 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 14:50:57.056 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:57.063 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:57.100 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 14:50:57.160 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:57.166 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:57.178 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-09 14:50:57.190 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-09 14:50:57.196 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-09 14:50:57.218 -05:00 [DBG] Start userinfo request
2018-02-09 14:50:57.230 -05:00 [DBG] Bearer token found in header
2018-02-09 14:50:57.920 -05:00 [DBG] js found in database: true
2018-02-09 14:50:58.476 -05:00 [DBG] js found in database: true
2018-02-09 14:50:58.556 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 14:50:58.574 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518205855,
    "exp": 1518209455,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518205852,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-09 14:50:58.598 -05:00 [DBG] Creating userinfo response
2018-02-09 14:50:58.612 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:50:58.621 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:50:58.733 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:58.742 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-09 14:50:58.747 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:50:58.844 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:58.976 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-09 14:50:58.986 -05:00 [DBG] End userinfo request
2018-02-09 14:50:59.028 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:50:59.046 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:50:59.058 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 14:50:59.066 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 14:50:59.079 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 14:50:59.099 -05:00 [DBG] Rendering check session result
2018-02-09 14:50:59.464 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:50:59.543 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:59.551 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:59.565 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:50:59.572 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:50:59.579 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:50:59.588 -05:00 [DBG] Start discovery request
2018-02-09 14:50:59.992 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:51:00.039 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:00.056 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:00.070 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 14:51:00.077 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 14:51:00.085 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 14:51:00.095 -05:00 [DBG] Rendering check session result
2018-02-09 14:51:06.186 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:51:06.193 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:51:06.202 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:51:06.210 -05:00 [DBG] Start discovery request
2018-02-09 14:51:06.603 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:51:07.113 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:51:07.118 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:51:07.127 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:51:07.136 -05:00 [DBG] Start key discovery request
2018-02-09 14:51:13.166 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:13.179 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:13.189 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-09 14:51:13.199 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-09 14:51:13.204 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-09 14:51:13.227 -05:00 [DBG] Processing signout request for 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:51:13.248 -05:00 [DBG] Start end session request validation
2018-02-09 14:51:13.265 -05:00 [DBG] Start identity token validation
2018-02-09 14:51:13.818 -05:00 [DBG] js found in database: true
2018-02-09 14:51:13.826 -05:00 [DBG] Client found: js / js.client
2018-02-09 14:51:13.908 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 14:51:13.916 -05:00 [DBG] Token validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1518205855,
    "exp": 1518206155,
    "iss": "http://localhost:5000",
    "aud": "js",
    "nonce": "c6f1ff10d2af4f95904af564b628567f",
    "iat": 1518205855,
    "at_hash": "OsVRChTVO5YQGlkekXXhhg",
    "sid": "b9575fbc8364c825a4d62644f098c849",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518205852,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-02-09 14:51:13.946 -05:00 [INF] End session request validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "PostLogOutUri": "http://localhost:5003/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjY3NTYzMGI1NWQ3NWE3OTI4MmNmZWI2OGNiN2I2MDZmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTgyMDU4NTUsImV4cCI6MTUxODIwNjE1NSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoianMiLCJub25jZSI6ImM2ZjFmZjEwZDJhZjRmOTU5MDRhZjU2NGI2Mjg1NjdmIiwiaWF0IjoxNTE4MjA1ODU1LCJhdF9oYXNoIjoiT3NWUkNoVFZPNVlRR2xrZWtYWGhoZyIsInNpZCI6ImI5NTc1ZmJjODM2NGM4MjVhNGQ2MjY0NGYwOThjODQ5Iiwic3ViIjoiOGFlMjRhMjgtNTlmNS00OGE2LTkyYzYtYzZjYWM1NTEzNDFiIiwiYXV0aF90aW1lIjoxNTE4MjA1ODUyLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.LvzEcwsjLiIc15D8nqcKqDjlSn-OcmyB16exsN-iWQunhZGpL-gTTJF6FfVVlzRum7zZPeBHlZZ-gmm20YXk97M8J8lj3hD4MJY4hLG0ED99OfNjYwX2sMunkzTAyFLeltdC8OxZm6GHk3z4iRzJhyrJhgjkQHpmZj6XHbbgzOT0LG7gBX1xfTy52LoknrffEmjTG-dNOlEJfVzQC7uliUfRubfvgBFh-zrN-3cLXOTHFCm2DPzzRutoK1CgaT9hDV0KcdrOlyOiijJVIVhr_HxSBv7MI_y018bR5BH6w7GSNQ4X1FvJu1baSNXb99fiEzIiNkkR5v350I_vQoFHdg",
    "post_logout_redirect_uri": "http://localhost:5003/index.html"
  }
}
2018-02-09 14:51:13.963 -05:00 [DBG] Success validating end session request from js
2018-02-09 14:51:14.023 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:14.034 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:14.216 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-02-09 14:51:14.225 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 14:51:14.235 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-02-09 14:51:14.243 -05:00 [INF] User logged out.
2018-02-09 14:51:14.719 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-09 14:51:14.732 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-09 14:51:14.738 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-09 14:51:14.760 -05:00 [DBG] Processing signout callback request
2018-02-09 14:51:15.391 -05:00 [DBG] js found in database: true
2018-02-09 14:51:15.401 -05:00 [DBG] No client front-channel logout URLs
2018-02-09 14:51:15.405 -05:00 [DBG] No client back-channel logout URLs
2018-02-09 14:51:15.410 -05:00 [INF] Successful signout callback.
2018-02-09 14:51:15.418 -05:00 [DBG] No client front-channel iframe urls
2018-02-09 14:51:15.423 -05:00 [DBG] No client back-channel iframe urls
2018-02-12 15:17:10.571 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 15:17:10.654 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 15:17:10.658 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 15:17:10.661 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 15:17:10.664 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 15:17:57.739 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 15:17:58.704 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:17:58.718 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:17:58.835 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 15:17:58.871 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 15:17:58.877 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 15:17:58.893 -05:00 [DBG] Start discovery request
2018-02-12 15:18:00.248 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 15:18:00.457 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 15:18:00.561 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 15:18:00.565 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 15:18:00.580 -05:00 [DBG] Start authorize request
2018-02-12 15:18:00.605 -05:00 [DBG] No user present in authorize request
2018-02-12 15:18:00.631 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 15:18:01.792 -05:00 [DBG] js found in database: true
2018-02-12 15:18:01.983 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:18:02.333 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:18:02.472 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:18:02.732 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:18:02.763 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 15:18:02.816 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "8181847d82ff49d1bafa3fe23c85245a",
  "Nonce": "0aab27dfaac24851869a1f2f1d35fa93",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "8181847d82ff49d1bafa3fe23c85245a",
    "nonce": "0aab27dfaac24851869a1f2f1d35fa93"
  }
}
2018-02-12 15:18:02.843 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 15:18:03.415 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 15:18:03.443 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 15:18:04.166 -05:00 [DBG] js found in database: true
2018-02-12 15:18:04.306 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:18:04.668 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:18:04.819 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:18:05.189 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:18:05.196 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 15:18:30.198 -05:00 [WRN] Invalid password for user 8ae24a28-59f5-48a6-92c6-c6cac551341b.
2018-02-12 15:18:30.208 -05:00 [WRN] User 8ae24a28-59f5-48a6-92c6-c6cac551341b failed to provide the correct password.
2018-02-12 15:18:40.091 -05:00 [DBG] Augmenting SignInContext
2018-02-12 15:18:40.099 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 15:18:40.104 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 15:18:40.108 -05:00 [DBG] Adding auth_time claim with value: 1518466720
2018-02-12 15:18:40.127 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 15:18:40.137 -05:00 [INF] User logged in.
2018-02-12 15:18:40.186 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:18:40.196 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:18:40.204 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 15:18:40.211 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 15:18:40.217 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 15:18:40.235 -05:00 [DBG] Start authorize callback request
2018-02-12 15:18:40.249 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 15:18:40.255 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 15:18:41.272 -05:00 [DBG] js found in database: true
2018-02-12 15:18:41.476 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:18:41.976 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:18:42.180 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:18:42.680 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:18:42.688 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 15:18:42.695 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "8181847d82ff49d1bafa3fe23c85245a",
  "Nonce": "0aab27dfaac24851869a1f2f1d35fa93",
  "SessionId": "cf032065b1c7c3451b3a9c6588b1a233",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "8181847d82ff49d1bafa3fe23c85245a",
    "nonce": "0aab27dfaac24851869a1f2f1d35fa93"
  }
}
2018-02-12 15:18:42.893 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 15:18:42.912 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 15:18:42.937 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 15:18:42.943 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 15:18:43.263 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 15:18:43.272 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 15:18:43.313 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "8181847d82ff49d1bafa3fe23c85245a",
  "Scope": "openid profile api1"
}
2018-02-12 15:18:43.357 -05:00 [DBG] Augmenting SignInContext
2018-02-12 15:18:43.362 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 15:18:43.712 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 15:18:43.775 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:18:43.781 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:18:43.796 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 15:18:43.803 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 15:18:43.810 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 15:18:43.820 -05:00 [DBG] Start discovery request
2018-02-12 15:18:44.185 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 15:18:44.211 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 15:18:44.277 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:18:44.284 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:18:44.298 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 15:18:44.306 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 15:18:44.312 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 15:18:44.332 -05:00 [DBG] Start key discovery request
2018-02-12 15:18:44.410 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 15:18:44.467 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:18:44.474 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:18:44.509 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 15:18:44.565 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:18:44.571 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:18:44.583 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 15:18:44.596 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 15:18:44.601 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 15:18:44.624 -05:00 [DBG] Start userinfo request
2018-02-12 15:18:44.635 -05:00 [DBG] Bearer token found in header
2018-02-12 15:18:45.322 -05:00 [DBG] js found in database: true
2018-02-12 15:18:45.858 -05:00 [DBG] js found in database: true
2018-02-12 15:18:45.935 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 15:18:45.952 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518466723,
    "exp": 1518470323,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518466720,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 15:18:45.972 -05:00 [DBG] Creating userinfo response
2018-02-12 15:18:45.985 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 15:18:45.996 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 15:18:46.157 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:18:46.165 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 15:18:46.170 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 15:18:46.315 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:18:46.476 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 15:18:46.485 -05:00 [DBG] End userinfo request
2018-02-12 15:18:46.518 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:18:46.530 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:18:46.540 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 15:18:46.548 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 15:18:46.553 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 15:18:46.565 -05:00 [DBG] Rendering check session result
2018-02-12 15:18:46.841 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 15:18:46.900 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:18:46.906 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:18:46.917 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 15:18:46.924 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 15:18:46.930 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 15:18:46.939 -05:00 [DBG] Start discovery request
2018-02-12 15:18:47.329 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 15:18:47.370 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:18:47.380 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:18:47.388 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 15:18:47.395 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 15:18:47.400 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 15:18:47.409 -05:00 [DBG] Rendering check session result
2018-02-12 15:18:48.973 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 15:18:48.979 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 15:18:48.984 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 15:18:48.992 -05:00 [DBG] Start discovery request
2018-02-12 15:18:49.341 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 15:18:49.840 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 15:18:49.846 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 15:18:49.852 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 15:18:49.862 -05:00 [DBG] Start key discovery request
2018-02-12 15:48:45.615 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 15:48:45.697 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 15:48:45.701 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 15:48:45.704 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 15:48:45.708 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 15:49:39.958 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 15:49:40.883 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:49:40.897 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:49:41.017 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 15:49:41.054 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 15:49:41.060 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 15:49:41.075 -05:00 [DBG] Start discovery request
2018-02-12 15:49:42.405 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 15:49:42.613 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 15:49:42.728 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 15:49:42.733 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 15:49:42.748 -05:00 [DBG] Start authorize request
2018-02-12 15:49:42.775 -05:00 [DBG] No user present in authorize request
2018-02-12 15:49:42.802 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 15:49:43.863 -05:00 [DBG] js found in database: true
2018-02-12 15:49:44.045 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:49:44.374 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:49:44.504 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:49:44.764 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:49:44.791 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 15:49:44.850 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "5c61e113a19749eda87255f16c7b514b",
  "Nonce": "f6abc4f789ca4e98b33c75f59a8662c5",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "5c61e113a19749eda87255f16c7b514b",
    "nonce": "f6abc4f789ca4e98b33c75f59a8662c5"
  }
}
2018-02-12 15:49:44.877 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 15:49:45.415 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 15:49:45.442 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 15:49:46.101 -05:00 [DBG] js found in database: true
2018-02-12 15:49:46.240 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:49:46.566 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:49:46.698 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:49:47.026 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:49:47.033 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 15:50:11.701 -05:00 [DBG] Augmenting SignInContext
2018-02-12 15:50:11.715 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 15:50:11.722 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 15:50:11.736 -05:00 [DBG] Adding auth_time claim with value: 1518468611
2018-02-12 15:50:11.755 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 15:50:11.764 -05:00 [INF] User logged in.
2018-02-12 15:50:11.813 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:50:11.821 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:50:11.830 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 15:50:11.837 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 15:50:11.841 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 15:50:11.859 -05:00 [DBG] Start authorize callback request
2018-02-12 15:50:11.871 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 15:50:11.875 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 15:50:12.857 -05:00 [DBG] js found in database: true
2018-02-12 15:50:13.075 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:50:13.571 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:50:13.766 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:50:14.248 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:50:14.255 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 15:50:14.260 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "5c61e113a19749eda87255f16c7b514b",
  "Nonce": "f6abc4f789ca4e98b33c75f59a8662c5",
  "SessionId": "6af1521582216f47eba69f7096400750",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "5c61e113a19749eda87255f16c7b514b",
    "nonce": "f6abc4f789ca4e98b33c75f59a8662c5"
  }
}
2018-02-12 15:50:14.447 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 15:50:14.465 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 15:50:14.489 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 15:50:14.495 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 15:50:14.811 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 15:50:14.817 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 15:50:14.854 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "5c61e113a19749eda87255f16c7b514b",
  "Scope": "openid profile api1"
}
2018-02-12 15:50:14.899 -05:00 [DBG] Augmenting SignInContext
2018-02-12 15:50:14.904 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 15:50:15.279 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 15:50:15.341 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:50:15.347 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:50:15.358 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 15:50:15.364 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 15:50:15.369 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 15:50:15.379 -05:00 [DBG] Start discovery request
2018-02-12 15:50:15.709 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 15:50:15.734 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 15:50:15.784 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:50:15.789 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:50:15.800 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 15:50:15.807 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 15:50:15.814 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 15:50:15.829 -05:00 [DBG] Start key discovery request
2018-02-12 15:50:15.910 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 15:50:15.963 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:50:15.969 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:50:15.999 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 15:50:16.049 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:50:16.055 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:50:16.065 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 15:50:16.076 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 15:50:16.080 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 15:50:16.100 -05:00 [DBG] Start userinfo request
2018-02-12 15:50:16.110 -05:00 [DBG] Bearer token found in header
2018-02-12 15:50:16.735 -05:00 [DBG] js found in database: true
2018-02-12 15:50:17.233 -05:00 [DBG] js found in database: true
2018-02-12 15:50:17.307 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 15:50:17.324 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518468614,
    "exp": 1518472214,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518468611,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 15:50:17.343 -05:00 [DBG] Creating userinfo response
2018-02-12 15:50:17.354 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 15:50:17.362 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 15:50:17.462 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:50:17.469 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 15:50:17.476 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 15:50:17.557 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:50:17.678 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 15:50:17.686 -05:00 [DBG] End userinfo request
2018-02-12 15:50:17.717 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:50:17.728 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:50:17.740 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 15:50:17.746 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 15:50:17.752 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 15:50:17.763 -05:00 [DBG] Rendering check session result
2018-02-12 15:50:18.033 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 15:50:18.087 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:50:18.093 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:50:18.105 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 15:50:18.110 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 15:50:18.115 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 15:50:18.123 -05:00 [DBG] Start discovery request
2018-02-12 15:50:18.446 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 15:50:18.471 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:50:18.478 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:50:18.486 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 15:50:18.491 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 15:50:18.496 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 15:50:18.504 -05:00 [DBG] Rendering check session result
2018-02-12 15:53:19.078 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 15:53:19.161 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 15:53:19.164 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 15:53:19.167 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 15:53:19.170 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 15:55:10.381 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 15:55:10.459 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 15:55:10.463 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 15:55:10.466 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 15:55:10.470 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 15:55:41.133 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 15:55:42.087 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:55:42.102 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:55:42.234 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 15:55:42.270 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 15:55:42.277 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 15:55:42.293 -05:00 [DBG] Start discovery request
2018-02-12 15:55:43.659 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 15:55:43.882 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 15:55:43.985 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 15:55:43.990 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 15:55:44.005 -05:00 [DBG] Start authorize request
2018-02-12 15:55:44.030 -05:00 [DBG] No user present in authorize request
2018-02-12 15:55:44.055 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 15:55:45.253 -05:00 [DBG] js found in database: true
2018-02-12 15:55:45.435 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:55:45.789 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:55:45.949 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:55:46.228 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:55:46.256 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 15:55:46.310 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "4fd4e9b5830c43089903809a38ff719d",
  "Nonce": "f1388504a4a745d8a7f88665c6717a1f",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "4fd4e9b5830c43089903809a38ff719d",
    "nonce": "f1388504a4a745d8a7f88665c6717a1f"
  }
}
2018-02-12 15:55:46.339 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 15:55:46.922 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 15:55:46.950 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 15:55:47.627 -05:00 [DBG] js found in database: true
2018-02-12 15:55:47.765 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:55:48.105 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:55:48.246 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:55:48.598 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:55:48.606 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 15:56:06.526 -05:00 [DBG] Augmenting SignInContext
2018-02-12 15:56:06.534 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 15:56:06.538 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 15:56:06.542 -05:00 [DBG] Adding auth_time claim with value: 1518468966
2018-02-12 15:56:06.563 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 15:56:06.572 -05:00 [INF] User logged in.
2018-02-12 15:56:06.624 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:56:06.633 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:56:06.643 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 15:56:06.650 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 15:56:06.656 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 15:56:06.681 -05:00 [DBG] Start authorize callback request
2018-02-12 15:56:06.696 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 15:56:06.701 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 15:56:07.774 -05:00 [DBG] js found in database: true
2018-02-12 15:56:07.984 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:56:08.504 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:56:08.705 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:56:09.245 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:56:09.252 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 15:56:09.259 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "4fd4e9b5830c43089903809a38ff719d",
  "Nonce": "f1388504a4a745d8a7f88665c6717a1f",
  "SessionId": "ad174717aa4419cee51dc800c5e9a412",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "4fd4e9b5830c43089903809a38ff719d",
    "nonce": "f1388504a4a745d8a7f88665c6717a1f"
  }
}
2018-02-12 15:56:09.472 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 15:56:09.490 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 15:56:09.515 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 15:56:09.520 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 15:56:09.873 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 15:56:09.879 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 15:56:09.914 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "4fd4e9b5830c43089903809a38ff719d",
  "Scope": "openid profile api1"
}
2018-02-12 15:56:09.955 -05:00 [DBG] Augmenting SignInContext
2018-02-12 15:56:09.960 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 15:56:10.327 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 15:56:10.386 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:56:10.392 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:56:10.403 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 15:56:10.411 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 15:56:10.419 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 15:56:10.428 -05:00 [DBG] Start discovery request
2018-02-12 15:56:10.792 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 15:56:10.817 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 15:56:10.868 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:56:10.874 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:56:10.887 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 15:56:10.897 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 15:56:10.905 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 15:56:10.921 -05:00 [DBG] Start key discovery request
2018-02-12 15:56:11.021 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 15:56:11.071 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:56:11.076 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:56:11.108 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 15:56:11.161 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:56:11.173 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:56:11.185 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 15:56:11.196 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 15:56:11.201 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 15:56:11.223 -05:00 [DBG] Start userinfo request
2018-02-12 15:56:11.234 -05:00 [DBG] Bearer token found in header
2018-02-12 15:56:11.902 -05:00 [DBG] js found in database: true
2018-02-12 15:56:12.419 -05:00 [DBG] js found in database: true
2018-02-12 15:56:12.492 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 15:56:12.508 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518468969,
    "exp": 1518472569,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518468966,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 15:56:12.534 -05:00 [DBG] Creating userinfo response
2018-02-12 15:56:12.545 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 15:56:12.553 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 15:56:12.659 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:56:12.666 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 15:56:12.672 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 15:56:12.757 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:56:12.897 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 15:56:12.905 -05:00 [DBG] End userinfo request
2018-02-12 15:56:12.936 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:56:12.945 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 15:56:12.954 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 15:56:12.960 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 15:56:12.965 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 15:56:12.974 -05:00 [DBG] Rendering check session result
2018-02-12 15:58:06.161 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 15:58:06.240 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 15:58:06.245 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 15:58:06.248 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 15:58:06.252 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 15:59:36.780 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 15:59:37.749 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 15:59:37.765 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 15:59:37.894 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 15:59:37.931 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 15:59:37.937 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 15:59:37.952 -05:00 [DBG] Start discovery request
2018-02-12 15:59:39.321 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 15:59:39.534 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 15:59:39.639 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 15:59:39.645 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 15:59:39.664 -05:00 [DBG] Start authorize request
2018-02-12 15:59:39.689 -05:00 [DBG] No user present in authorize request
2018-02-12 15:59:39.720 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 15:59:40.838 -05:00 [DBG] js found in database: true
2018-02-12 15:59:41.028 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:59:41.385 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:59:41.537 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:59:41.814 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:59:41.850 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 15:59:41.922 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "b90a4d9db66c4f1b991131ad28b2c8ca",
  "Nonce": "ed65ad287c9944f69d4b59f3aa08d90a",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "b90a4d9db66c4f1b991131ad28b2c8ca",
    "nonce": "ed65ad287c9944f69d4b59f3aa08d90a"
  }
}
2018-02-12 15:59:41.950 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 15:59:42.539 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 15:59:42.569 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 15:59:43.279 -05:00 [DBG] js found in database: true
2018-02-12 15:59:43.412 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:59:43.765 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:59:43.913 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 15:59:44.243 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 15:59:44.251 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:00:05.991 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:00:05.999 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 16:00:06.003 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 16:00:06.008 -05:00 [DBG] Adding auth_time claim with value: 1518469205
2018-02-12 16:00:06.028 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:00:06.037 -05:00 [INF] User logged in.
2018-02-12 16:00:06.087 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:00:06.095 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:00:06.104 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 16:00:06.111 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 16:00:06.116 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 16:00:06.134 -05:00 [DBG] Start authorize callback request
2018-02-12 16:00:06.147 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:00:06.151 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:00:07.220 -05:00 [DBG] js found in database: true
2018-02-12 16:00:07.438 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:00:07.966 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:00:08.178 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:00:08.705 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:00:08.712 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:00:08.717 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "b90a4d9db66c4f1b991131ad28b2c8ca",
  "Nonce": "ed65ad287c9944f69d4b59f3aa08d90a",
  "SessionId": "73d38f6919ec3206ac0c514d86b9eda9",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "b90a4d9db66c4f1b991131ad28b2c8ca",
    "nonce": "ed65ad287c9944f69d4b59f3aa08d90a"
  }
}
2018-02-12 16:00:08.923 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 16:00:08.941 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 16:00:08.969 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 16:00:08.974 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:00:09.320 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 16:00:09.327 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 16:00:09.363 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "b90a4d9db66c4f1b991131ad28b2c8ca",
  "Scope": "openid profile api1"
}
2018-02-12 16:00:09.412 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:00:09.418 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:00:09.795 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:00:09.863 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:00:09.872 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:00:09.883 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:00:09.888 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:00:09.893 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:00:09.901 -05:00 [DBG] Start discovery request
2018-02-12 16:00:10.254 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:00:10.280 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 16:00:10.332 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:00:10.338 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:00:10.348 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 16:00:10.355 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 16:00:10.360 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 16:00:10.374 -05:00 [DBG] Start key discovery request
2018-02-12 16:00:10.460 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:00:10.515 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:00:10.520 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:00:10.550 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:00:10.611 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:00:10.617 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:00:10.626 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 16:00:10.637 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 16:00:10.641 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 16:00:10.662 -05:00 [DBG] Start userinfo request
2018-02-12 16:00:10.673 -05:00 [DBG] Bearer token found in header
2018-02-12 16:00:11.318 -05:00 [DBG] js found in database: true
2018-02-12 16:00:11.850 -05:00 [DBG] js found in database: true
2018-02-12 16:00:11.922 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:00:11.938 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518469209,
    "exp": 1518472809,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518469205,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 16:00:11.961 -05:00 [DBG] Creating userinfo response
2018-02-12 16:00:11.973 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:00:11.982 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:00:12.145 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:00:12.154 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 16:00:12.160 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:00:12.299 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:00:12.451 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 16:00:12.459 -05:00 [DBG] End userinfo request
2018-02-12 16:00:12.490 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:00:12.501 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:00:12.510 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:00:12.520 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:00:12.526 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:00:12.537 -05:00 [DBG] Rendering check session result
2018-02-12 16:00:12.839 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:00:12.895 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:00:12.901 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:00:12.911 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:00:12.917 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:00:12.923 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:00:12.932 -05:00 [DBG] Start discovery request
2018-02-12 16:00:13.286 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:00:13.311 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:00:13.320 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:00:13.328 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:00:13.334 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:00:13.340 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:00:13.348 -05:00 [DBG] Rendering check session result
2018-02-12 16:00:44.734 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:00:44.744 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:00:44.753 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-12 16:00:44.761 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-12 16:00:44.767 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-12 16:00:44.783 -05:00 [DBG] Processing signout request for 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:00:44.800 -05:00 [DBG] Start end session request validation
2018-02-12 16:00:44.815 -05:00 [DBG] Start identity token validation
2018-02-12 16:00:45.376 -05:00 [DBG] js found in database: true
2018-02-12 16:00:45.389 -05:00 [DBG] Client found: js / js.client
2018-02-12 16:00:45.504 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:00:45.512 -05:00 [DBG] Token validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1518469209,
    "exp": 1518469509,
    "iss": "http://localhost:5000",
    "aud": "js",
    "nonce": "ed65ad287c9944f69d4b59f3aa08d90a",
    "iat": 1518469209,
    "at_hash": "lz5az4aoWlQBqBvYqQcLxA",
    "sid": "73d38f6919ec3206ac0c514d86b9eda9",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518469205,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-02-12 16:00:45.540 -05:00 [INF] End session request validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "PostLogOutUri": "http://localhost:5003/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjY3NTYzMGI1NWQ3NWE3OTI4MmNmZWI2OGNiN2I2MDZmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTg0NjkyMDksImV4cCI6MTUxODQ2OTUwOSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoianMiLCJub25jZSI6ImVkNjVhZDI4N2M5OTQ0ZjY5ZDRiNTlmM2FhMDhkOTBhIiwiaWF0IjoxNTE4NDY5MjA5LCJhdF9oYXNoIjoibHo1YXo0YW9XbFFCcUJ2WXFRY0x4QSIsInNpZCI6IjczZDM4ZjY5MTllYzMyMDZhYzBjNTE0ZDg2YjllZGE5Iiwic3ViIjoiOGFlMjRhMjgtNTlmNS00OGE2LTkyYzYtYzZjYWM1NTEzNDFiIiwiYXV0aF90aW1lIjoxNTE4NDY5MjA1LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.F-8XiHgp7JMO2Ko1gGwJBx1CHzPKez3b4gCNrJNnba0zqHS2lf7x2JVKAyrJgq5Wr_ZhLnV-dCUVtPcErzTXHorJp88sXJkYXmEAEklVdPkRNjHDv0p_I7FhRRZ3ogOSozZ3AZgYxFgW2ZjwuZkZj7G9nK-7bPtTBriAYMfFF1oCcVb8ZLYCo_cgTXymgQfTDiIM8W-64V2a6BhNbQdaWFGbW7DOt3fIS64crEfg_w_M0ia30t2S0WGVIU1pr6O9wnuaXGaAdTWNBl3x0d1-NEYWJxrtqhHjHO0lgLMBTJ3lil06YOGIAmKUXJa4cY3JsW4XTlDGua5LHtvcPLBtNw",
    "post_logout_redirect_uri": "http://localhost:5003/index.html"
  }
}
2018-02-12 16:00:45.551 -05:00 [DBG] Success validating end session request from js
2018-02-12 16:00:45.604 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:00:45.613 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:00:45.819 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-02-12 16:00:45.832 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 16:00:45.842 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-02-12 16:00:45.852 -05:00 [INF] User logged out.
2018-02-12 16:00:46.375 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-12 16:00:46.389 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-12 16:00:46.395 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-12 16:00:46.420 -05:00 [DBG] Processing signout callback request
2018-02-12 16:00:47.034 -05:00 [DBG] js found in database: true
2018-02-12 16:00:47.041 -05:00 [DBG] No client front-channel logout URLs
2018-02-12 16:00:47.045 -05:00 [DBG] No client back-channel logout URLs
2018-02-12 16:00:47.051 -05:00 [INF] Successful signout callback.
2018-02-12 16:00:47.062 -05:00 [DBG] No client front-channel iframe urls
2018-02-12 16:00:47.067 -05:00 [DBG] No client back-channel iframe urls
2018-02-12 16:00:54.273 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:00:54.333 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:00:54.339 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:00:54.352 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:00:54.358 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:00:54.363 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:00:54.372 -05:00 [DBG] Start discovery request
2018-02-12 16:00:54.730 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:00:54.759 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 16:00:54.767 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 16:00:54.775 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 16:00:54.787 -05:00 [DBG] Start authorize request
2018-02-12 16:00:54.792 -05:00 [DBG] No user present in authorize request
2018-02-12 16:00:54.796 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:00:55.340 -05:00 [DBG] js found in database: true
2018-02-12 16:00:55.454 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:00:55.723 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:00:55.845 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:00:56.129 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:00:56.137 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:00:56.143 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ef38abc36c724c5e8db68f1bd4b8b2ab",
  "Nonce": "3ff8b60cbcde4e859ce97eb6f8d08afc",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "ef38abc36c724c5e8db68f1bd4b8b2ab",
    "nonce": "3ff8b60cbcde4e859ce97eb6f8d08afc"
  }
}
2018-02-12 16:00:56.154 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 16:00:56.235 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 16:00:56.246 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:00:56.969 -05:00 [DBG] js found in database: true
2018-02-12 16:00:57.110 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:00:57.468 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:00:57.621 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:00:57.982 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:00:57.989 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:01:15.569 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:01:15.574 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 16:01:15.578 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 16:01:15.583 -05:00 [DBG] Adding auth_time claim with value: 1518469275
2018-02-12 16:01:15.587 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:01:15.599 -05:00 [INF] User logged in.
2018-02-12 16:01:15.637 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:01:15.645 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:01:15.655 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 16:01:15.663 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 16:01:15.668 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 16:01:15.676 -05:00 [DBG] Start authorize callback request
2018-02-12 16:01:15.681 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:01:15.689 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:01:16.982 -05:00 [DBG] js found in database: true
2018-02-12 16:01:17.251 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:01:17.933 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:01:18.192 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:01:18.825 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:01:18.833 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:01:18.840 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ef38abc36c724c5e8db68f1bd4b8b2ab",
  "Nonce": "3ff8b60cbcde4e859ce97eb6f8d08afc",
  "SessionId": "e08704a88f6ada45488673c7737e1de3",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "ef38abc36c724c5e8db68f1bd4b8b2ab",
    "nonce": "3ff8b60cbcde4e859ce97eb6f8d08afc"
  }
}
2018-02-12 16:01:18.984 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 16:01:18.989 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 16:01:18.992 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 16:01:18.998 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:01:19.162 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 16:01:19.169 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 16:01:19.180 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "ef38abc36c724c5e8db68f1bd4b8b2ab",
  "Scope": "openid profile api1"
}
2018-02-12 16:01:19.189 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:01:19.194 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:01:19.536 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:01:19.594 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:01:19.600 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:01:19.611 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:01:19.617 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:01:19.622 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:01:19.630 -05:00 [DBG] Start discovery request
2018-02-12 16:01:19.991 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:01:20.013 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 16:01:20.062 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:01:20.068 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:01:20.077 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 16:01:20.084 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 16:01:20.090 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 16:01:20.101 -05:00 [DBG] Start key discovery request
2018-02-12 16:01:20.161 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:01:20.216 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:01:20.222 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:01:20.249 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:01:20.298 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:01:20.304 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:01:20.313 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 16:01:20.319 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 16:01:20.324 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 16:01:20.332 -05:00 [DBG] Start userinfo request
2018-02-12 16:01:20.337 -05:00 [DBG] Bearer token found in header
2018-02-12 16:01:20.875 -05:00 [DBG] js found in database: true
2018-02-12 16:01:21.376 -05:00 [DBG] js found in database: true
2018-02-12 16:01:21.454 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:01:21.459 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518469279,
    "exp": 1518472879,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518469275,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 16:01:21.468 -05:00 [DBG] Creating userinfo response
2018-02-12 16:01:21.479 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:01:21.482 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:01:21.647 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:01:21.654 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 16:01:21.660 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:01:21.800 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:01:21.969 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 16:01:21.978 -05:00 [DBG] End userinfo request
2018-02-12 16:01:22.004 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:01:22.013 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:01:22.021 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:01:22.026 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:01:22.035 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:01:22.043 -05:00 [DBG] Rendering check session result
2018-02-12 16:05:55.560 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 16:05:55.637 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 16:05:55.641 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 16:05:55.644 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 16:05:55.648 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 16:06:57.684 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:06:58.662 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:06:58.680 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:06:58.796 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:06:58.832 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:06:58.838 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:06:58.854 -05:00 [DBG] Start discovery request
2018-02-12 16:07:00.187 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:07:00.400 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 16:07:00.498 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 16:07:00.503 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 16:07:00.518 -05:00 [DBG] Start authorize request
2018-02-12 16:07:00.543 -05:00 [DBG] No user present in authorize request
2018-02-12 16:07:00.569 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:07:01.683 -05:00 [DBG] js found in database: true
2018-02-12 16:07:01.893 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:07:02.227 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:07:02.376 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:07:02.642 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:07:02.673 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:07:02.739 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "cbaff7a616da47e7a7835fb573bfba5a",
  "Nonce": "85991573fc484643bc94d2c7622b4655",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "cbaff7a616da47e7a7835fb573bfba5a",
    "nonce": "85991573fc484643bc94d2c7622b4655"
  }
}
2018-02-12 16:07:02.764 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 16:07:03.345 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 16:07:03.381 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:07:04.074 -05:00 [DBG] js found in database: true
2018-02-12 16:07:04.214 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:07:04.544 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:07:04.679 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:07:05.021 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:07:05.028 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:07:26.134 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:07:26.143 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 16:07:26.147 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 16:07:26.152 -05:00 [DBG] Adding auth_time claim with value: 1518469646
2018-02-12 16:07:26.177 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:07:26.187 -05:00 [INF] User logged in.
2018-02-12 16:07:26.241 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:07:26.251 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:07:26.260 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 16:07:26.267 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 16:07:26.272 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 16:07:26.292 -05:00 [DBG] Start authorize callback request
2018-02-12 16:07:26.305 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:07:26.311 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:07:27.333 -05:00 [DBG] js found in database: true
2018-02-12 16:07:27.559 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:07:28.089 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:07:28.300 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:07:28.814 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:07:28.822 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:07:28.828 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "cbaff7a616da47e7a7835fb573bfba5a",
  "Nonce": "85991573fc484643bc94d2c7622b4655",
  "SessionId": "81848cd718d579711596690601538a66",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "cbaff7a616da47e7a7835fb573bfba5a",
    "nonce": "85991573fc484643bc94d2c7622b4655"
  }
}
2018-02-12 16:07:29.034 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 16:07:29.056 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 16:07:29.081 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 16:07:29.088 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:07:29.418 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 16:07:29.425 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 16:07:29.460 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "cbaff7a616da47e7a7835fb573bfba5a",
  "Scope": "openid profile api1"
}
2018-02-12 16:07:29.502 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:07:29.508 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:07:29.887 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:07:29.942 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:07:29.948 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:07:29.961 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:07:29.968 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:07:29.974 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:07:29.983 -05:00 [DBG] Start discovery request
2018-02-12 16:07:30.333 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:07:30.359 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 16:07:30.413 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:07:30.420 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:07:30.434 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 16:07:30.442 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 16:07:30.447 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 16:07:30.461 -05:00 [DBG] Start key discovery request
2018-02-12 16:07:30.541 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:07:30.596 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:07:30.602 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:07:30.634 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:07:30.691 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:07:30.696 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:07:30.708 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 16:07:30.723 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 16:07:30.729 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 16:07:30.756 -05:00 [DBG] Start userinfo request
2018-02-12 16:07:30.769 -05:00 [DBG] Bearer token found in header
2018-02-12 16:07:31.432 -05:00 [DBG] js found in database: true
2018-02-12 16:07:31.953 -05:00 [DBG] js found in database: true
2018-02-12 16:07:32.028 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:07:32.044 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518469649,
    "exp": 1518473249,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518469646,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 16:07:32.062 -05:00 [DBG] Creating userinfo response
2018-02-12 16:07:32.074 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:07:32.084 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:07:32.190 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:07:32.197 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 16:07:32.204 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:07:32.289 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:07:32.417 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 16:07:32.426 -05:00 [DBG] End userinfo request
2018-02-12 16:07:32.459 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:07:32.471 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:07:32.482 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:07:32.490 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:07:32.494 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:07:32.504 -05:00 [DBG] Rendering check session result
2018-02-12 16:07:32.807 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:07:32.863 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:07:32.869 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:07:32.880 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:07:32.888 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:07:32.894 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:07:32.903 -05:00 [DBG] Start discovery request
2018-02-12 16:07:33.262 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:07:33.290 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:07:33.299 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:07:33.308 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:07:33.313 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:07:33.319 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:07:33.328 -05:00 [DBG] Rendering check session result
2018-02-12 16:07:58.369 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:07:58.381 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:07:58.391 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-12 16:07:58.400 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-12 16:07:58.406 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-12 16:07:58.427 -05:00 [DBG] Processing signout request for 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:07:58.446 -05:00 [DBG] Start end session request validation
2018-02-12 16:07:58.466 -05:00 [DBG] Start identity token validation
2018-02-12 16:07:59.039 -05:00 [DBG] js found in database: true
2018-02-12 16:07:59.048 -05:00 [DBG] Client found: js / js.client
2018-02-12 16:07:59.129 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:07:59.138 -05:00 [DBG] Token validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1518469649,
    "exp": 1518469949,
    "iss": "http://localhost:5000",
    "aud": "js",
    "nonce": "85991573fc484643bc94d2c7622b4655",
    "iat": 1518469649,
    "at_hash": "vJAY4iiqY7tk8wNcH95UBQ",
    "sid": "81848cd718d579711596690601538a66",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518469646,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-02-12 16:07:59.162 -05:00 [INF] End session request validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "PostLogOutUri": "http://localhost:5003/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjY3NTYzMGI1NWQ3NWE3OTI4MmNmZWI2OGNiN2I2MDZmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTg0Njk2NDksImV4cCI6MTUxODQ2OTk0OSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoianMiLCJub25jZSI6Ijg1OTkxNTczZmM0ODQ2NDNiYzk0ZDJjNzYyMmI0NjU1IiwiaWF0IjoxNTE4NDY5NjQ5LCJhdF9oYXNoIjoidkpBWTRpaXFZN3RrOHdOY0g5NVVCUSIsInNpZCI6IjgxODQ4Y2Q3MThkNTc5NzExNTk2NjkwNjAxNTM4YTY2Iiwic3ViIjoiOGFlMjRhMjgtNTlmNS00OGE2LTkyYzYtYzZjYWM1NTEzNDFiIiwiYXV0aF90aW1lIjoxNTE4NDY5NjQ2LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.An5sA8kXzD3sGO_0LAskMqitadZuMR2x0w4_xvRzD4fQg192xLthqQtfbBZQ1YCfpfCcbtabBJed4HTWsqAuAk9Gzt2Wrw3vmcLyfxEWVzGQutGMpZHUNfThx7Q09oO5-UIstCuMyMRoH_BXTVPpDiVMfENcUiTd2WGAYgnuklOBS4yLzBGV-EQMGmEaAFJ_Gn95Wy0RCc7kQ1vhzG6UcemZGN_C_QQloI4dLf8Bgp8zzEMPqcBIc2gUptMpE-7txUZ6J4Xb9wX2czW5VWD7HahwuF-GCMo8m5Rar-kASgf7u2c-6fTOBg5VKc5huZLBq_D329k40acPH2rvvnr3VA",
    "post_logout_redirect_uri": "http://localhost:5003/index.html"
  }
}
2018-02-12 16:07:59.175 -05:00 [DBG] Success validating end session request from js
2018-02-12 16:07:59.232 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:07:59.242 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:07:59.436 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-02-12 16:07:59.446 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 16:07:59.457 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-02-12 16:07:59.468 -05:00 [INF] User logged out.
2018-02-12 16:08:00.080 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-12 16:08:00.099 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-12 16:08:00.107 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-12 16:08:00.130 -05:00 [DBG] Processing signout callback request
2018-02-12 16:08:00.859 -05:00 [DBG] js found in database: true
2018-02-12 16:08:00.865 -05:00 [DBG] No client front-channel logout URLs
2018-02-12 16:08:00.871 -05:00 [DBG] No client back-channel logout URLs
2018-02-12 16:08:00.876 -05:00 [INF] Successful signout callback.
2018-02-12 16:08:00.887 -05:00 [DBG] No client front-channel iframe urls
2018-02-12 16:08:00.893 -05:00 [DBG] No client back-channel iframe urls
2018-02-12 16:08:08.732 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:08:08.795 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:08:08.802 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:08:08.814 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:08:08.821 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:08:08.827 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:08:08.836 -05:00 [DBG] Start discovery request
2018-02-12 16:08:09.220 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:08:09.255 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 16:08:09.263 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 16:08:09.268 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 16:08:09.279 -05:00 [DBG] Start authorize request
2018-02-12 16:08:09.284 -05:00 [DBG] No user present in authorize request
2018-02-12 16:08:09.288 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:08:09.854 -05:00 [DBG] js found in database: true
2018-02-12 16:08:09.976 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:08:10.270 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:08:10.390 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:08:10.672 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:08:10.680 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:08:10.686 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "6e3881f47082471db6d0440dc01d0b96",
  "Nonce": "daa7c00c985c45369389d435cec1f9ec",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "6e3881f47082471db6d0440dc01d0b96",
    "nonce": "daa7c00c985c45369389d435cec1f9ec"
  }
}
2018-02-12 16:08:10.705 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 16:08:10.789 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 16:08:10.800 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:08:11.533 -05:00 [DBG] js found in database: true
2018-02-12 16:08:11.682 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:08:12.044 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:08:12.192 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:08:12.553 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:08:12.561 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:08:26.381 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:08:26.387 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 16:08:26.392 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 16:08:26.397 -05:00 [DBG] Adding auth_time claim with value: 1518469706
2018-02-12 16:08:26.404 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:08:26.414 -05:00 [INF] User logged in.
2018-02-12 16:08:26.460 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:08:26.472 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:08:26.481 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 16:08:26.487 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 16:08:26.492 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 16:08:26.501 -05:00 [DBG] Start authorize callback request
2018-02-12 16:08:26.506 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:08:26.512 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:08:27.751 -05:00 [DBG] js found in database: true
2018-02-12 16:08:28.016 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:08:28.661 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:08:28.918 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:08:29.560 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:08:29.566 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:08:29.573 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "6e3881f47082471db6d0440dc01d0b96",
  "Nonce": "daa7c00c985c45369389d435cec1f9ec",
  "SessionId": "eab560f7cf3b7d770b9b88e86ee75fe3",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "6e3881f47082471db6d0440dc01d0b96",
    "nonce": "daa7c00c985c45369389d435cec1f9ec"
  }
}
2018-02-12 16:08:29.736 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 16:08:29.742 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 16:08:29.747 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 16:08:29.751 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:08:29.922 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 16:08:29.926 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 16:08:29.936 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "6e3881f47082471db6d0440dc01d0b96",
  "Scope": "openid profile api1"
}
2018-02-12 16:08:29.945 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:08:29.952 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:08:45.249 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:08:45.321 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:08:45.328 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:08:45.339 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:08:45.347 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:08:45.353 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:08:45.362 -05:00 [DBG] Start discovery request
2018-02-12 16:08:45.720 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:08:45.749 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 16:08:45.811 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:08:45.818 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:08:45.831 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 16:08:45.837 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 16:08:45.843 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 16:08:45.853 -05:00 [DBG] Start key discovery request
2018-02-12 16:08:45.934 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:08:45.989 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:08:45.995 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:08:46.027 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:08:46.086 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:08:46.095 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:08:46.107 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 16:08:46.114 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 16:08:46.122 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 16:08:46.132 -05:00 [DBG] Start userinfo request
2018-02-12 16:08:46.136 -05:00 [DBG] Bearer token found in header
2018-02-12 16:08:46.692 -05:00 [DBG] js found in database: true
2018-02-12 16:08:47.262 -05:00 [DBG] js found in database: true
2018-02-12 16:08:47.350 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:08:47.357 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518469709,
    "exp": 1518473309,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518469706,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 16:08:47.366 -05:00 [DBG] Creating userinfo response
2018-02-12 16:08:47.374 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:08:47.386 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:08:47.535 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:08:47.542 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 16:08:47.547 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:08:47.696 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:08:47.851 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 16:08:47.860 -05:00 [DBG] End userinfo request
2018-02-12 16:08:47.893 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:08:47.903 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:08:47.912 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:08:47.917 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:08:47.923 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:08:47.932 -05:00 [DBG] Rendering check session result
2018-02-12 16:11:31.036 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 16:11:31.117 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 16:11:31.120 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 16:11:31.124 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 16:11:31.127 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 16:12:16.924 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:12:17.831 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:12:17.845 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:12:17.965 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:12:18.003 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:12:18.010 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:12:18.024 -05:00 [DBG] Start discovery request
2018-02-12 16:12:19.359 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:12:19.574 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 16:12:19.681 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 16:12:19.687 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 16:12:19.704 -05:00 [DBG] Start authorize request
2018-02-12 16:12:19.730 -05:00 [DBG] No user present in authorize request
2018-02-12 16:12:19.755 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:12:20.822 -05:00 [DBG] js found in database: true
2018-02-12 16:12:20.997 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:12:21.349 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:12:21.485 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:12:21.742 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:12:21.766 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:12:21.827 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "24f8ad45488143d2a8bc90a70a0789e2",
  "Nonce": "8a5aff6177744828993fc71f07a468fb",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "24f8ad45488143d2a8bc90a70a0789e2",
    "nonce": "8a5aff6177744828993fc71f07a468fb"
  }
}
2018-02-12 16:12:21.862 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 16:12:22.434 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 16:12:22.463 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:12:23.163 -05:00 [DBG] js found in database: true
2018-02-12 16:12:23.298 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:12:23.638 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:12:23.775 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:12:24.114 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:12:24.122 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:12:44.070 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:12:44.077 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 16:12:44.081 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 16:12:44.086 -05:00 [DBG] Adding auth_time claim with value: 1518469964
2018-02-12 16:12:44.105 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:12:44.114 -05:00 [INF] User logged in.
2018-02-12 16:12:44.164 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:12:44.172 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:12:44.180 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 16:12:44.188 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 16:12:44.192 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 16:12:44.212 -05:00 [DBG] Start authorize callback request
2018-02-12 16:12:44.224 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:12:44.230 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:12:45.269 -05:00 [DBG] js found in database: true
2018-02-12 16:12:45.487 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:12:46.006 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:12:46.227 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:12:46.742 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:12:46.749 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:12:46.755 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "24f8ad45488143d2a8bc90a70a0789e2",
  "Nonce": "8a5aff6177744828993fc71f07a468fb",
  "SessionId": "e144ef0c73d41cff602579097d3f7040",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "24f8ad45488143d2a8bc90a70a0789e2",
    "nonce": "8a5aff6177744828993fc71f07a468fb"
  }
}
2018-02-12 16:12:46.971 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 16:12:46.988 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 16:12:47.015 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 16:12:47.019 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:12:47.365 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 16:12:47.371 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 16:12:47.407 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "24f8ad45488143d2a8bc90a70a0789e2",
  "Scope": "openid profile api1"
}
2018-02-12 16:12:47.453 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:12:47.459 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:12:47.945 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:12:48.000 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:12:48.006 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:12:48.017 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:12:48.022 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:12:48.028 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:12:48.037 -05:00 [DBG] Start discovery request
2018-02-12 16:12:48.377 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:12:48.401 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 16:12:48.453 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:12:48.459 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:12:48.470 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 16:12:48.478 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 16:12:48.483 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 16:12:48.499 -05:00 [DBG] Start key discovery request
2018-02-12 16:12:48.591 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:12:48.646 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:12:48.652 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:12:48.682 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:12:48.745 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:12:48.751 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:12:48.761 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 16:12:48.774 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 16:12:48.780 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 16:12:48.803 -05:00 [DBG] Start userinfo request
2018-02-12 16:12:48.813 -05:00 [DBG] Bearer token found in header
2018-02-12 16:12:49.479 -05:00 [DBG] js found in database: true
2018-02-12 16:12:49.985 -05:00 [DBG] js found in database: true
2018-02-12 16:12:50.058 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:12:50.073 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518469967,
    "exp": 1518473567,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518469964,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 16:12:50.094 -05:00 [DBG] Creating userinfo response
2018-02-12 16:12:50.105 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:12:50.114 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:12:50.288 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:12:50.296 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 16:12:50.301 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:12:50.455 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:12:50.603 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 16:12:50.611 -05:00 [DBG] End userinfo request
2018-02-12 16:12:50.641 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:12:50.649 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:12:50.657 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:12:50.665 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:12:50.670 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:12:50.680 -05:00 [DBG] Rendering check session result
2018-02-12 16:17:52.773 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 16:17:52.858 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 16:17:52.862 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 16:17:52.867 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 16:17:52.870 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 16:19:37.241 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:19:38.167 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:19:38.181 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:19:38.300 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:19:38.335 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:19:38.341 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:19:38.354 -05:00 [DBG] Start discovery request
2018-02-12 16:19:39.689 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:19:39.892 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 16:19:39.993 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 16:19:39.998 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 16:19:40.015 -05:00 [DBG] Start authorize request
2018-02-12 16:19:40.042 -05:00 [DBG] No user present in authorize request
2018-02-12 16:19:40.070 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:19:41.146 -05:00 [DBG] js found in database: true
2018-02-12 16:19:41.324 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:19:41.656 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:19:41.791 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:19:42.059 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:19:42.082 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:19:42.136 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "5b8ce92add8a419eb94a2075af4d471b",
  "Nonce": "da5a45e6a83d483793ee12e8dc81c18c",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "5b8ce92add8a419eb94a2075af4d471b",
    "nonce": "da5a45e6a83d483793ee12e8dc81c18c"
  }
}
2018-02-12 16:19:42.164 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 16:19:42.739 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 16:19:42.768 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:19:43.460 -05:00 [DBG] js found in database: true
2018-02-12 16:19:43.601 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:19:43.939 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:19:44.096 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:19:44.432 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:19:44.440 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:20:17.214 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:20:17.221 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 16:20:17.225 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 16:20:17.230 -05:00 [DBG] Adding auth_time claim with value: 1518470417
2018-02-12 16:20:17.251 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:20:17.260 -05:00 [INF] User logged in.
2018-02-12 16:20:17.311 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:20:17.319 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:20:17.326 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 16:20:17.335 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 16:20:17.339 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 16:20:17.358 -05:00 [DBG] Start authorize callback request
2018-02-12 16:20:17.371 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:20:17.375 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:20:18.409 -05:00 [DBG] js found in database: true
2018-02-12 16:20:18.611 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:20:19.115 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:20:19.332 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:20:19.869 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:20:19.878 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:20:19.883 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "5b8ce92add8a419eb94a2075af4d471b",
  "Nonce": "da5a45e6a83d483793ee12e8dc81c18c",
  "SessionId": "8e28f9169083031133c921b1e3d47e48",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "5b8ce92add8a419eb94a2075af4d471b",
    "nonce": "da5a45e6a83d483793ee12e8dc81c18c"
  }
}
2018-02-12 16:20:20.091 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 16:20:20.109 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 16:20:20.133 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 16:20:20.139 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:20:20.509 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 16:20:20.515 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 16:20:20.550 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "5b8ce92add8a419eb94a2075af4d471b",
  "Scope": "openid profile api1"
}
2018-02-12 16:20:20.591 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:20:20.596 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:20:21.059 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:20:21.118 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:20:21.124 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:20:21.135 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:20:21.140 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:20:21.145 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:20:21.153 -05:00 [DBG] Start discovery request
2018-02-12 16:20:21.500 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:20:21.528 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 16:20:21.580 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:20:21.586 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:20:21.594 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 16:20:21.601 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 16:20:21.606 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 16:20:21.619 -05:00 [DBG] Start key discovery request
2018-02-12 16:20:21.694 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:20:21.748 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:20:21.754 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:20:21.781 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:20:21.833 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:20:21.840 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:20:21.853 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 16:20:21.864 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 16:20:21.868 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 16:20:21.891 -05:00 [DBG] Start userinfo request
2018-02-12 16:20:21.902 -05:00 [DBG] Bearer token found in header
2018-02-12 16:20:22.561 -05:00 [DBG] js found in database: true
2018-02-12 16:20:23.083 -05:00 [DBG] js found in database: true
2018-02-12 16:20:23.157 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:20:23.173 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518470420,
    "exp": 1518474020,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518470417,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 16:20:23.199 -05:00 [DBG] Creating userinfo response
2018-02-12 16:20:23.213 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:20:23.224 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:20:23.327 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:20:23.334 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 16:20:23.340 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:20:23.428 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:20:23.551 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 16:20:23.559 -05:00 [DBG] End userinfo request
2018-02-12 16:20:23.604 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:20:23.612 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:20:23.621 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:20:23.631 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:20:23.637 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:20:23.648 -05:00 [DBG] Rendering check session result
2018-02-12 16:28:56.794 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 16:28:56.883 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 16:28:56.887 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 16:28:56.890 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 16:28:56.894 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 16:32:49.603 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:32:50.560 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:32:50.574 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:32:50.697 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:32:50.732 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:32:50.738 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:32:50.755 -05:00 [DBG] Start discovery request
2018-02-12 16:32:52.078 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:32:52.304 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 16:32:52.389 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 16:32:52.393 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 16:32:52.415 -05:00 [DBG] Start authorize request
2018-02-12 16:32:52.445 -05:00 [DBG] No user present in authorize request
2018-02-12 16:32:52.474 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:32:53.582 -05:00 [DBG] js found in database: true
2018-02-12 16:32:53.766 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:32:54.107 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:32:54.239 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:32:54.498 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:32:54.522 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:32:54.576 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "e46f014414b14338a310089adcde7cf5",
  "Nonce": "01270e49ad80402087b7a69eacc65991",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "e46f014414b14338a310089adcde7cf5",
    "nonce": "01270e49ad80402087b7a69eacc65991"
  }
}
2018-02-12 16:32:54.607 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 16:32:55.149 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 16:32:55.178 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:32:55.860 -05:00 [DBG] js found in database: true
2018-02-12 16:32:56.022 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:32:56.354 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:32:56.491 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:32:56.823 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:32:56.833 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:33:16.368 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:33:16.376 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 16:33:16.380 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 16:33:16.386 -05:00 [DBG] Adding auth_time claim with value: 1518471196
2018-02-12 16:33:16.406 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:33:16.417 -05:00 [INF] User logged in.
2018-02-12 16:33:16.470 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:33:16.479 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:33:16.488 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 16:33:16.495 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 16:33:16.499 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 16:33:16.517 -05:00 [DBG] Start authorize callback request
2018-02-12 16:33:16.530 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:33:16.534 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:33:17.616 -05:00 [DBG] js found in database: true
2018-02-12 16:33:17.835 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:33:18.364 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:33:18.571 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:33:19.123 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:33:19.131 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:33:19.135 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "e46f014414b14338a310089adcde7cf5",
  "Nonce": "01270e49ad80402087b7a69eacc65991",
  "SessionId": "5f6955280f7b02968120cb58c71eb783",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "e46f014414b14338a310089adcde7cf5",
    "nonce": "01270e49ad80402087b7a69eacc65991"
  }
}
2018-02-12 16:33:19.354 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 16:33:19.373 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 16:33:19.397 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 16:33:19.403 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:33:19.756 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 16:33:19.762 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 16:33:19.797 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "e46f014414b14338a310089adcde7cf5",
  "Scope": "openid profile api1"
}
2018-02-12 16:33:19.850 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:33:19.856 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:33:20.343 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:33:20.400 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:33:20.407 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:33:20.418 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:33:20.426 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:33:20.432 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:33:20.440 -05:00 [DBG] Start discovery request
2018-02-12 16:33:20.803 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:33:20.826 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 16:33:20.885 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:33:20.892 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:33:20.903 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 16:33:20.910 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 16:33:20.914 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 16:33:20.930 -05:00 [DBG] Start key discovery request
2018-02-12 16:33:21.015 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:33:21.075 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:33:21.081 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:33:21.111 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:33:21.164 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:33:21.170 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:33:21.181 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 16:33:21.196 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 16:33:21.201 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 16:33:21.225 -05:00 [DBG] Start userinfo request
2018-02-12 16:33:21.236 -05:00 [DBG] Bearer token found in header
2018-02-12 16:33:21.888 -05:00 [DBG] js found in database: true
2018-02-12 16:33:22.414 -05:00 [DBG] js found in database: true
2018-02-12 16:33:22.496 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:33:22.513 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518471199,
    "exp": 1518474799,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518471196,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 16:33:22.530 -05:00 [DBG] Creating userinfo response
2018-02-12 16:33:22.542 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:33:22.551 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:33:22.665 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:33:22.674 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 16:33:22.680 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:33:22.765 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:33:22.893 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 16:33:22.901 -05:00 [DBG] End userinfo request
2018-02-12 16:33:22.940 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:33:22.951 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:33:22.960 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:33:22.967 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:33:22.972 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:33:22.982 -05:00 [DBG] Rendering check session result
2018-02-12 16:33:55.343 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:33:55.397 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:33:55.405 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:33:55.417 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:33:55.424 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:33:55.432 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:33:55.443 -05:00 [DBG] Start discovery request
2018-02-12 16:33:55.777 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:33:55.806 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:33:55.815 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:33:55.826 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:33:55.835 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:33:55.842 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:33:55.852 -05:00 [DBG] Rendering check session result
2018-02-12 16:36:46.632 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 16:36:46.710 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 16:36:46.714 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 16:36:46.717 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 16:36:46.720 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 16:37:31.934 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:37:32.868 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:37:32.884 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:37:33.000 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:37:33.036 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:37:33.043 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:37:33.058 -05:00 [DBG] Start discovery request
2018-02-12 16:37:34.399 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:37:34.600 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 16:37:34.693 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 16:37:34.699 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 16:37:34.714 -05:00 [DBG] Start authorize request
2018-02-12 16:37:34.739 -05:00 [DBG] No user present in authorize request
2018-02-12 16:37:34.765 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:37:35.840 -05:00 [DBG] js found in database: true
2018-02-12 16:37:36.039 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:37:36.391 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:37:36.529 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:37:36.794 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:37:36.819 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:37:36.873 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "26f57dc272994c56b3f03cba9c20da74",
  "Nonce": "2808a801df9c4d5eb147eb02baf0315e",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "26f57dc272994c56b3f03cba9c20da74",
    "nonce": "2808a801df9c4d5eb147eb02baf0315e"
  }
}
2018-02-12 16:37:36.898 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 16:37:37.449 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 16:37:37.476 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:37:38.153 -05:00 [DBG] js found in database: true
2018-02-12 16:37:38.298 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:37:38.643 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:37:38.779 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:37:39.116 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:37:39.124 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:37:56.488 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:37:56.496 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 16:37:56.501 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 16:37:56.506 -05:00 [DBG] Adding auth_time claim with value: 1518471476
2018-02-12 16:37:56.524 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:37:56.532 -05:00 [INF] User logged in.
2018-02-12 16:37:56.584 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:37:56.593 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:37:56.602 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 16:37:56.608 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 16:37:56.613 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 16:37:56.632 -05:00 [DBG] Start authorize callback request
2018-02-12 16:37:56.644 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:37:56.649 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:37:57.722 -05:00 [DBG] js found in database: true
2018-02-12 16:37:57.935 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:37:58.472 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:37:58.692 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:37:59.215 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:37:59.227 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:37:59.235 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "26f57dc272994c56b3f03cba9c20da74",
  "Nonce": "2808a801df9c4d5eb147eb02baf0315e",
  "SessionId": "cf173bfd19dd6f75c2b1c993688d703b",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "26f57dc272994c56b3f03cba9c20da74",
    "nonce": "2808a801df9c4d5eb147eb02baf0315e"
  }
}
2018-02-12 16:37:59.439 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 16:37:59.459 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 16:37:59.484 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 16:37:59.489 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:37:59.830 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 16:37:59.836 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 16:37:59.889 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "26f57dc272994c56b3f03cba9c20da74",
  "Scope": "openid profile api1"
}
2018-02-12 16:37:59.936 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:37:59.940 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:38:00.429 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:38:00.487 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:38:00.493 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:38:00.506 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:38:00.513 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:38:00.519 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:38:00.528 -05:00 [DBG] Start discovery request
2018-02-12 16:38:00.879 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:38:00.904 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 16:38:00.958 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:38:00.964 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:38:00.975 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 16:38:00.981 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 16:38:00.986 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 16:38:01.000 -05:00 [DBG] Start key discovery request
2018-02-12 16:38:01.073 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:38:01.126 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:38:01.134 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:38:01.167 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:38:01.221 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:38:01.226 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:38:01.236 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 16:38:01.249 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 16:38:01.255 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 16:38:01.280 -05:00 [DBG] Start userinfo request
2018-02-12 16:38:01.290 -05:00 [DBG] Bearer token found in header
2018-02-12 16:38:02.009 -05:00 [DBG] js found in database: true
2018-02-12 16:38:02.527 -05:00 [DBG] js found in database: true
2018-02-12 16:38:02.602 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:38:02.619 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518471479,
    "exp": 1518475079,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518471476,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 16:38:02.639 -05:00 [DBG] Creating userinfo response
2018-02-12 16:38:02.655 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:38:02.666 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:38:02.770 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:38:02.779 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 16:38:02.784 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:38:02.875 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:38:03.008 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 16:38:03.016 -05:00 [DBG] End userinfo request
2018-02-12 16:38:03.048 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:38:03.057 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:38:03.066 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:38:03.073 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:38:03.080 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:38:03.093 -05:00 [DBG] Rendering check session result
2018-02-12 16:39:03.844 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 16:39:03.943 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 16:39:03.947 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 16:39:03.951 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 16:39:03.955 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 16:39:45.121 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:39:46.057 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:39:46.073 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:39:46.203 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:39:46.245 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:39:46.251 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:39:46.269 -05:00 [DBG] Start discovery request
2018-02-12 16:39:47.620 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:39:47.849 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 16:39:47.941 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 16:39:47.946 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 16:39:47.961 -05:00 [DBG] Start authorize request
2018-02-12 16:39:47.985 -05:00 [DBG] No user present in authorize request
2018-02-12 16:39:48.009 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:39:49.104 -05:00 [DBG] js found in database: true
2018-02-12 16:39:49.294 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:39:49.633 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:39:49.769 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:39:50.031 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:39:50.056 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:39:50.113 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "0660b426918b4f37bfeb77b1c7d79ddf",
  "Nonce": "20bf70c8ae6643229a05b41966f69d13",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "0660b426918b4f37bfeb77b1c7d79ddf",
    "nonce": "20bf70c8ae6643229a05b41966f69d13"
  }
}
2018-02-12 16:39:50.145 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 16:39:50.710 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 16:39:50.737 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:39:51.408 -05:00 [DBG] js found in database: true
2018-02-12 16:39:51.539 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:39:51.873 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:39:52.021 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:39:52.354 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:39:52.363 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:40:09.045 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:40:09.052 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 16:40:09.056 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 16:40:09.061 -05:00 [DBG] Adding auth_time claim with value: 1518471609
2018-02-12 16:40:09.081 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:40:09.091 -05:00 [INF] User logged in.
2018-02-12 16:40:09.143 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:40:09.153 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:40:09.162 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 16:40:09.169 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 16:40:09.176 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 16:40:09.197 -05:00 [DBG] Start authorize callback request
2018-02-12 16:40:09.210 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:40:09.216 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:40:10.289 -05:00 [DBG] js found in database: true
2018-02-12 16:40:10.500 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:40:11.030 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:40:11.245 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:40:11.777 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:40:11.784 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:40:11.791 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "0660b426918b4f37bfeb77b1c7d79ddf",
  "Nonce": "20bf70c8ae6643229a05b41966f69d13",
  "SessionId": "b3686e2ab3ba127753dfc37ad38cc6d8",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "0660b426918b4f37bfeb77b1c7d79ddf",
    "nonce": "20bf70c8ae6643229a05b41966f69d13"
  }
}
2018-02-12 16:40:11.989 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 16:40:12.007 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 16:40:12.031 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 16:40:12.036 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:40:12.371 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 16:40:12.377 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 16:40:12.420 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "0660b426918b4f37bfeb77b1c7d79ddf",
  "Scope": "openid profile api1"
}
2018-02-12 16:40:12.462 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:40:12.467 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:40:12.968 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:40:13.030 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:40:13.035 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:40:13.046 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:40:13.054 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:40:13.059 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:40:13.075 -05:00 [DBG] Start discovery request
2018-02-12 16:40:13.430 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:40:13.459 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 16:40:13.514 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:40:13.520 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:40:13.529 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 16:40:13.535 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 16:40:13.540 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 16:40:13.554 -05:00 [DBG] Start key discovery request
2018-02-12 16:40:13.629 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:40:13.683 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:40:13.689 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:40:13.716 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:40:13.768 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:40:13.774 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:40:13.785 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 16:40:13.796 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 16:40:13.802 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 16:40:13.825 -05:00 [DBG] Start userinfo request
2018-02-12 16:40:13.836 -05:00 [DBG] Bearer token found in header
2018-02-12 16:40:14.501 -05:00 [DBG] js found in database: true
2018-02-12 16:40:15.007 -05:00 [DBG] js found in database: true
2018-02-12 16:40:15.080 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:40:15.095 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518471612,
    "exp": 1518475212,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518471609,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 16:40:15.117 -05:00 [DBG] Creating userinfo response
2018-02-12 16:40:15.129 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:40:15.138 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:40:15.238 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:40:15.245 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 16:40:15.250 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:40:15.334 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:40:15.457 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 16:40:15.466 -05:00 [DBG] End userinfo request
2018-02-12 16:40:15.496 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:40:15.504 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:40:15.513 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:40:15.520 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:40:15.524 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:40:15.535 -05:00 [DBG] Rendering check session result
2018-02-12 16:43:44.597 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 16:43:44.683 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 16:43:44.687 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 16:43:44.690 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 16:43:44.693 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 16:44:37.123 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:44:38.048 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:44:38.064 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:44:38.186 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:44:38.220 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:44:38.226 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:44:38.240 -05:00 [DBG] Start discovery request
2018-02-12 16:44:39.558 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:44:39.772 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-12 16:44:39.862 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-12 16:44:39.868 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-12 16:44:39.883 -05:00 [DBG] Start authorize request
2018-02-12 16:44:39.908 -05:00 [DBG] No user present in authorize request
2018-02-12 16:44:39.935 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:44:41.016 -05:00 [DBG] js found in database: true
2018-02-12 16:44:41.204 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:44:41.542 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:44:41.678 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:44:41.968 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:44:41.993 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:44:42.045 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ff870fe818b24c269db377d03df20d1d",
  "Nonce": "3ddd4f404f8a494cb0bc23423c941223",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "ff870fe818b24c269db377d03df20d1d",
    "nonce": "3ddd4f404f8a494cb0bc23423c941223"
  }
}
2018-02-12 16:44:42.072 -05:00 [INF] Showing login: User is not authenticated
2018-02-12 16:44:42.623 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-12 16:44:42.652 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:44:43.305 -05:00 [DBG] js found in database: true
2018-02-12 16:44:43.439 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:44:43.761 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:44:43.893 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:44:44.226 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:44:44.233 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:45:06.536 -05:00 [WRN] Invalid password for user 8ae24a28-59f5-48a6-92c6-c6cac551341b.
2018-02-12 16:45:06.546 -05:00 [WRN] User 8ae24a28-59f5-48a6-92c6-c6cac551341b failed to provide the correct password.
2018-02-12 16:45:15.522 -05:00 [WRN] Invalid password for user 8ae24a28-59f5-48a6-92c6-c6cac551341b.
2018-02-12 16:45:15.530 -05:00 [WRN] User 8ae24a28-59f5-48a6-92c6-c6cac551341b failed to provide the correct password.
2018-02-12 16:45:32.984 -05:00 [WRN] Invalid password for user 8ae24a28-59f5-48a6-92c6-c6cac551341b.
2018-02-12 16:45:32.992 -05:00 [WRN] User 8ae24a28-59f5-48a6-92c6-c6cac551341b failed to provide the correct password.
2018-02-12 16:46:05.840 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:46:05.847 -05:00 [DBG] Adding idp claim with value: local
2018-02-12 16:46:05.851 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-12 16:46:05.857 -05:00 [DBG] Adding auth_time claim with value: 1518471965
2018-02-12 16:46:05.882 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:46:05.891 -05:00 [INF] User logged in.
2018-02-12 16:46:05.942 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:46:05.951 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:46:05.963 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-12 16:46:05.970 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-12 16:46:05.975 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-12 16:46:05.994 -05:00 [DBG] Start authorize callback request
2018-02-12 16:46:06.005 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:46:06.009 -05:00 [DBG] Start authorize request protocol validation
2018-02-12 16:46:07.019 -05:00 [DBG] js found in database: true
2018-02-12 16:46:07.220 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:46:07.729 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:46:07.938 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:46:08.440 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-12 16:46:08.449 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-12 16:46:08.454 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ff870fe818b24c269db377d03df20d1d",
  "Nonce": "3ddd4f404f8a494cb0bc23423c941223",
  "SessionId": "4b443d321427455b086aa5e2f1d912e8",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "ff870fe818b24c269db377d03df20d1d",
    "nonce": "3ddd4f404f8a494cb0bc23423c941223"
  }
}
2018-02-12 16:46:08.648 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-12 16:46:08.666 -05:00 [DBG] Creating Implicit Flow response.
2018-02-12 16:46:08.692 -05:00 [DBG] Getting claims for access token for client: js
2018-02-12 16:46:08.698 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-12 16:46:09.019 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-12 16:46:09.025 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-12 16:46:09.060 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "ff870fe818b24c269db377d03df20d1d",
  "Scope": "openid profile api1"
}
2018-02-12 16:46:09.102 -05:00 [DBG] Augmenting SignInContext
2018-02-12 16:46:09.108 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-12 16:46:09.598 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-12 16:46:09.651 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:46:09.657 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:46:09.667 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-12 16:46:09.673 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-12 16:46:09.679 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-12 16:46:09.689 -05:00 [DBG] Start discovery request
2018-02-12 16:46:10.043 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-12 16:46:10.067 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-12 16:46:10.118 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:46:10.124 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:46:10.134 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-12 16:46:10.142 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-12 16:46:10.146 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-12 16:46:10.165 -05:00 [DBG] Start key discovery request
2018-02-12 16:46:10.248 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:46:10.299 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:46:10.305 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:46:10.337 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-12 16:46:10.389 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-12 16:46:10.396 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-12 16:46:10.406 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-12 16:46:10.418 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-12 16:46:10.425 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-12 16:46:10.453 -05:00 [DBG] Start userinfo request
2018-02-12 16:46:10.465 -05:00 [DBG] Bearer token found in header
2018-02-12 16:46:11.113 -05:00 [DBG] js found in database: true
2018-02-12 16:46:11.627 -05:00 [DBG] js found in database: true
2018-02-12 16:46:11.711 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-12 16:46:11.727 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518471968,
    "exp": 1518475568,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518471965,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-12 16:46:11.747 -05:00 [DBG] Creating userinfo response
2018-02-12 16:46:11.759 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:46:11.769 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:46:11.869 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:46:11.877 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-12 16:46:11.882 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-12 16:46:11.969 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-12 16:46:12.092 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-12 16:46:12.101 -05:00 [DBG] End userinfo request
2018-02-12 16:46:12.135 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:46:12.144 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-12 16:46:12.151 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-12 16:46:12.161 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-12 16:46:12.166 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-12 16:46:12.176 -05:00 [DBG] Rendering check session result
2018-02-12 16:51:34.936 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 16:51:35.018 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 16:51:35.021 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 16:51:35.025 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 16:51:35.028 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 16:54:07.597 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 16:54:07.684 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 16:54:07.689 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 16:54:07.693 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 16:54:07.697 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-12 17:00:45.530 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-12 17:00:45.609 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-12 17:00:45.612 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-12 17:00:45.616 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-12 17:00:45.620 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-13 09:20:49.563 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-13 09:20:49.646 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-13 09:20:49.650 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-13 09:20:49.654 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-13 09:20:49.658 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-13 09:22:07.745 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-13 09:22:07.825 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-13 09:22:07.829 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-13 09:22:07.833 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-13 09:22:07.837 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-13 09:23:05.982 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:23:07.167 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:23:07.183 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:23:07.314 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:23:07.354 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:23:07.359 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:23:07.375 -05:00 [DBG] Start discovery request
2018-02-13 09:23:08.741 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:23:08.960 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-13 09:23:09.092 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-13 09:23:09.098 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-13 09:23:09.113 -05:00 [DBG] Start authorize request
2018-02-13 09:23:09.138 -05:00 [DBG] No user present in authorize request
2018-02-13 09:23:09.163 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:23:10.277 -05:00 [DBG] js found in database: true
2018-02-13 09:23:10.470 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:23:10.834 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:23:10.979 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:23:11.244 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:23:11.273 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:23:11.334 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "543958e209aa43b7a8ebbadc62c2511b",
  "Nonce": "7535499bcaec44d5bd3c2c359052df35",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "543958e209aa43b7a8ebbadc62c2511b",
    "nonce": "7535499bcaec44d5bd3c2c359052df35"
  }
}
2018-02-13 09:23:11.362 -05:00 [INF] Showing login: User is not authenticated
2018-02-13 09:23:11.979 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-13 09:23:12.011 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:23:12.688 -05:00 [DBG] js found in database: true
2018-02-13 09:23:12.824 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:23:13.153 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:23:13.305 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:23:13.663 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:23:13.672 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:23:41.393 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:23:41.402 -05:00 [DBG] Adding idp claim with value: local
2018-02-13 09:23:41.406 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-13 09:23:41.412 -05:00 [DBG] Adding auth_time claim with value: 1518531821
2018-02-13 09:23:41.431 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:23:41.440 -05:00 [INF] User logged in.
2018-02-13 09:23:41.490 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:23:41.502 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:23:41.509 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-13 09:23:41.517 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-13 09:23:41.526 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-13 09:23:41.548 -05:00 [DBG] Start authorize callback request
2018-02-13 09:23:41.563 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:23:41.568 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:23:42.646 -05:00 [DBG] js found in database: true
2018-02-13 09:23:42.860 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:23:43.415 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:23:43.630 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:23:44.161 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:23:44.169 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:23:44.175 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "543958e209aa43b7a8ebbadc62c2511b",
  "Nonce": "7535499bcaec44d5bd3c2c359052df35",
  "SessionId": "e949a5c553a69739763b6ae8fad0703e",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "543958e209aa43b7a8ebbadc62c2511b",
    "nonce": "7535499bcaec44d5bd3c2c359052df35"
  }
}
2018-02-13 09:23:44.377 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-13 09:23:44.395 -05:00 [DBG] Creating Implicit Flow response.
2018-02-13 09:23:44.420 -05:00 [DBG] Getting claims for access token for client: js
2018-02-13 09:23:44.426 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:23:44.829 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-13 09:23:44.835 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-13 09:23:44.873 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "543958e209aa43b7a8ebbadc62c2511b",
  "Scope": "openid profile api1"
}
2018-02-13 09:23:44.914 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:23:44.919 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:23:45.380 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:23:45.440 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:23:45.447 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:23:45.457 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:23:45.462 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:23:45.468 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:23:45.476 -05:00 [DBG] Start discovery request
2018-02-13 09:23:45.827 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:23:45.854 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-13 09:23:45.905 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:23:45.911 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:23:45.922 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-13 09:23:45.931 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-13 09:23:45.935 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-13 09:23:45.950 -05:00 [DBG] Start key discovery request
2018-02-13 09:23:46.032 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:23:46.087 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:23:46.093 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:23:46.124 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:23:46.177 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:23:46.184 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:23:46.195 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-13 09:23:46.208 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-13 09:23:46.214 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-13 09:23:46.237 -05:00 [DBG] Start userinfo request
2018-02-13 09:23:46.249 -05:00 [DBG] Bearer token found in header
2018-02-13 09:23:46.918 -05:00 [DBG] js found in database: true
2018-02-13 09:23:47.431 -05:00 [DBG] js found in database: true
2018-02-13 09:23:47.508 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-13 09:23:47.524 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518531824,
    "exp": 1518535424,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518531821,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-13 09:23:47.545 -05:00 [DBG] Creating userinfo response
2018-02-13 09:23:47.557 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:23:47.569 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:23:47.745 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:23:47.752 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-13 09:23:47.759 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:23:47.905 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:23:48.058 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-13 09:23:48.067 -05:00 [DBG] End userinfo request
2018-02-13 09:23:48.103 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:23:48.117 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:23:48.129 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-13 09:23:48.137 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-13 09:23:48.142 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-13 09:23:48.153 -05:00 [DBG] Rendering check session result
2018-02-13 09:23:48.396 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:23:48.454 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:23:48.460 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:23:48.471 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:23:48.477 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:23:48.482 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:23:48.491 -05:00 [DBG] Start discovery request
2018-02-13 09:23:48.848 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:24:46.323 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:24:46.341 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:24:46.360 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-13 09:24:46.380 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-13 09:24:46.402 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-13 09:24:46.410 -05:00 [DBG] Rendering check session result
2018-02-13 09:27:41.015 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-13 09:27:41.097 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-13 09:27:41.102 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-13 09:27:41.105 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-13 09:27:41.108 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-13 09:28:54.021 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:28:55.022 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:28:55.038 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:28:55.162 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:28:55.199 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:28:55.205 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:28:55.220 -05:00 [DBG] Start discovery request
2018-02-13 09:28:56.597 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:28:56.808 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-13 09:28:56.889 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-13 09:28:56.894 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-13 09:28:56.909 -05:00 [DBG] Start authorize request
2018-02-13 09:28:56.935 -05:00 [DBG] No user present in authorize request
2018-02-13 09:28:56.962 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:28:58.081 -05:00 [DBG] js found in database: true
2018-02-13 09:28:58.287 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:28:58.630 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:28:58.774 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:28:59.049 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:28:59.079 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:28:59.135 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "d5f0416275a54c7097153370ba7dbfd3",
  "Nonce": "44bc330a06294b60b9f691ffedc87a88",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "d5f0416275a54c7097153370ba7dbfd3",
    "nonce": "44bc330a06294b60b9f691ffedc87a88"
  }
}
2018-02-13 09:28:59.161 -05:00 [INF] Showing login: User is not authenticated
2018-02-13 09:28:59.742 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-13 09:28:59.770 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:29:00.457 -05:00 [DBG] js found in database: true
2018-02-13 09:29:00.600 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:29:00.939 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:29:01.079 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:29:01.425 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:29:01.432 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:29:28.796 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:29:28.804 -05:00 [DBG] Adding idp claim with value: local
2018-02-13 09:29:28.809 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-13 09:29:28.814 -05:00 [DBG] Adding auth_time claim with value: 1518532168
2018-02-13 09:29:28.835 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:29:28.845 -05:00 [INF] User logged in.
2018-02-13 09:29:28.903 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:29:28.913 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:29:28.921 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-13 09:29:28.928 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-13 09:29:28.933 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-13 09:29:28.954 -05:00 [DBG] Start authorize callback request
2018-02-13 09:29:28.969 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:29:28.975 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:29:30.105 -05:00 [DBG] js found in database: true
2018-02-13 09:29:30.320 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:29:30.867 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:29:31.090 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:29:31.620 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:29:31.630 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:29:31.638 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "d5f0416275a54c7097153370ba7dbfd3",
  "Nonce": "44bc330a06294b60b9f691ffedc87a88",
  "SessionId": "4d9a953bb43edd84181c86a8794609ef",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "d5f0416275a54c7097153370ba7dbfd3",
    "nonce": "44bc330a06294b60b9f691ffedc87a88"
  }
}
2018-02-13 09:29:31.854 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-13 09:29:31.874 -05:00 [DBG] Creating Implicit Flow response.
2018-02-13 09:29:31.900 -05:00 [DBG] Getting claims for access token for client: js
2018-02-13 09:29:31.906 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:29:32.271 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-13 09:29:32.278 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-13 09:29:32.315 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "d5f0416275a54c7097153370ba7dbfd3",
  "Scope": "openid profile api1"
}
2018-02-13 09:29:32.358 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:29:32.363 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:29:32.814 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:29:32.876 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:29:32.882 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:29:32.896 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:29:32.906 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:29:32.913 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:29:32.924 -05:00 [DBG] Start discovery request
2018-02-13 09:29:33.314 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:29:33.339 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-13 09:29:33.403 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:29:33.415 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:29:33.427 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-13 09:29:33.433 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-13 09:29:33.440 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-13 09:29:33.454 -05:00 [DBG] Start key discovery request
2018-02-13 09:29:33.541 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:29:33.605 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:29:33.612 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:29:33.645 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:29:33.710 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:29:33.718 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:29:33.731 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-13 09:29:33.743 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-13 09:29:33.748 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-13 09:29:33.770 -05:00 [DBG] Start userinfo request
2018-02-13 09:29:33.781 -05:00 [DBG] Bearer token found in header
2018-02-13 09:29:34.478 -05:00 [DBG] js found in database: true
2018-02-13 09:29:35.025 -05:00 [DBG] js found in database: true
2018-02-13 09:29:35.107 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-13 09:29:35.124 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518532172,
    "exp": 1518535772,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518532168,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-13 09:29:35.143 -05:00 [DBG] Creating userinfo response
2018-02-13 09:29:35.155 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:29:35.165 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:29:35.273 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:29:35.281 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-13 09:29:35.287 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:29:35.375 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:29:35.509 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-13 09:29:35.518 -05:00 [DBG] End userinfo request
2018-02-13 09:29:35.552 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:29:35.563 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:29:35.575 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-13 09:29:35.582 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-13 09:29:35.589 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-13 09:29:35.604 -05:00 [DBG] Rendering check session result
2018-02-13 09:29:35.826 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:29:35.899 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:29:35.905 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:29:35.920 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:29:35.928 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:29:35.937 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:29:35.946 -05:00 [DBG] Start discovery request
2018-02-13 09:29:36.315 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:29:36.343 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:29:36.352 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:29:36.361 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-13 09:29:36.367 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-13 09:29:36.373 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-13 09:29:36.381 -05:00 [DBG] Rendering check session result
2018-02-13 09:31:09.187 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-13 09:31:09.276 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-13 09:31:09.281 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-13 09:31:09.284 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-13 09:31:09.287 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-13 09:32:08.049 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:32:09.019 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:32:09.034 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:32:09.154 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:32:09.195 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:32:09.201 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:32:09.215 -05:00 [DBG] Start discovery request
2018-02-13 09:32:10.558 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:32:10.770 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-13 09:32:10.885 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-13 09:32:10.891 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-13 09:32:10.905 -05:00 [DBG] Start authorize request
2018-02-13 09:32:10.930 -05:00 [DBG] No user present in authorize request
2018-02-13 09:32:10.956 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:32:12.088 -05:00 [DBG] js found in database: true
2018-02-13 09:32:12.270 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:32:12.636 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:32:12.775 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:32:13.046 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:32:13.074 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:32:13.129 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "cb26fe712e8045398de6138fb7eb6af8",
  "Nonce": "3f08d9a9deeb4e5c913bf7e02fedb213",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "cb26fe712e8045398de6138fb7eb6af8",
    "nonce": "3f08d9a9deeb4e5c913bf7e02fedb213"
  }
}
2018-02-13 09:32:13.155 -05:00 [INF] Showing login: User is not authenticated
2018-02-13 09:32:13.722 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-13 09:32:13.749 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:32:14.445 -05:00 [DBG] js found in database: true
2018-02-13 09:32:14.592 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:32:14.930 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:32:15.076 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:32:15.424 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:32:15.432 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:32:39.911 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:32:39.920 -05:00 [DBG] Adding idp claim with value: local
2018-02-13 09:32:39.924 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-13 09:32:39.930 -05:00 [DBG] Adding auth_time claim with value: 1518532359
2018-02-13 09:32:39.951 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:32:39.962 -05:00 [INF] User logged in.
2018-02-13 09:32:40.017 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:32:40.026 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:32:40.035 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-13 09:32:40.044 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-13 09:32:40.049 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-13 09:32:40.069 -05:00 [DBG] Start authorize callback request
2018-02-13 09:32:40.082 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:32:40.088 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:32:41.177 -05:00 [DBG] js found in database: true
2018-02-13 09:32:41.396 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:32:41.940 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:32:42.168 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:32:42.713 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:32:42.720 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:32:42.726 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "cb26fe712e8045398de6138fb7eb6af8",
  "Nonce": "3f08d9a9deeb4e5c913bf7e02fedb213",
  "SessionId": "3d08ba403c946ff2ddd1f3db41e183f6",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "cb26fe712e8045398de6138fb7eb6af8",
    "nonce": "3f08d9a9deeb4e5c913bf7e02fedb213"
  }
}
2018-02-13 09:32:42.931 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-13 09:32:42.950 -05:00 [DBG] Creating Implicit Flow response.
2018-02-13 09:32:42.976 -05:00 [DBG] Getting claims for access token for client: js
2018-02-13 09:32:42.981 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:32:43.354 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-13 09:32:43.361 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-13 09:32:43.398 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "cb26fe712e8045398de6138fb7eb6af8",
  "Scope": "openid profile api1"
}
2018-02-13 09:32:43.442 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:32:43.448 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:32:43.890 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:32:43.954 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:32:43.960 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:32:43.973 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:32:43.979 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:32:43.986 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:32:43.995 -05:00 [DBG] Start discovery request
2018-02-13 09:32:44.357 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:32:44.382 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-13 09:32:44.435 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:32:44.442 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:32:44.453 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-13 09:32:44.461 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-13 09:32:44.466 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-13 09:32:44.483 -05:00 [DBG] Start key discovery request
2018-02-13 09:32:44.571 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:32:44.628 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:32:44.635 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:32:44.669 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:32:44.726 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:32:44.732 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:32:44.747 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-13 09:32:44.759 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-13 09:32:44.764 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-13 09:32:44.785 -05:00 [DBG] Start userinfo request
2018-02-13 09:32:44.796 -05:00 [DBG] Bearer token found in header
2018-02-13 09:32:45.494 -05:00 [DBG] js found in database: true
2018-02-13 09:32:46.049 -05:00 [DBG] js found in database: true
2018-02-13 09:32:46.138 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-13 09:32:46.154 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518532363,
    "exp": 1518535963,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518532359,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-13 09:32:46.174 -05:00 [DBG] Creating userinfo response
2018-02-13 09:32:46.187 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:32:46.196 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:32:46.305 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:32:46.313 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-13 09:32:46.319 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:32:46.410 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:32:46.541 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-13 09:32:46.550 -05:00 [DBG] End userinfo request
2018-02-13 09:32:46.583 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:32:46.594 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:32:46.607 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-13 09:32:46.616 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-13 09:32:46.625 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-13 09:32:46.638 -05:00 [DBG] Rendering check session result
2018-02-13 09:32:46.846 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:32:46.918 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:32:46.925 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:32:46.938 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:32:46.945 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:32:46.954 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:32:46.962 -05:00 [DBG] Start discovery request
2018-02-13 09:32:47.346 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:32:47.375 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:32:47.384 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:32:47.394 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-13 09:32:47.401 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-13 09:32:47.407 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-13 09:32:47.416 -05:00 [DBG] Rendering check session result
2018-02-13 09:33:10.570 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:33:10.582 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:33:10.592 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-13 09:33:10.599 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-13 09:33:10.604 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-13 09:33:10.624 -05:00 [DBG] Processing signout request for 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:33:10.641 -05:00 [DBG] Start end session request validation
2018-02-13 09:33:10.658 -05:00 [DBG] Start identity token validation
2018-02-13 09:33:11.199 -05:00 [DBG] js found in database: true
2018-02-13 09:33:11.205 -05:00 [DBG] Client found: js / js.client
2018-02-13 09:33:11.288 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-13 09:33:11.298 -05:00 [DBG] Token validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1518532363,
    "exp": 1518532663,
    "iss": "http://localhost:5000",
    "aud": "js",
    "nonce": "3f08d9a9deeb4e5c913bf7e02fedb213",
    "iat": 1518532363,
    "at_hash": "1sB1le6yqNyfm3D9XIhcKA",
    "sid": "3d08ba403c946ff2ddd1f3db41e183f6",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518532359,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-02-13 09:33:11.321 -05:00 [INF] End session request validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "PostLogOutUri": "http://localhost:5003/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjY3NTYzMGI1NWQ3NWE3OTI4MmNmZWI2OGNiN2I2MDZmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTg1MzIzNjMsImV4cCI6MTUxODUzMjY2MywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoianMiLCJub25jZSI6IjNmMDhkOWE5ZGVlYjRlNWM5MTNiZjdlMDJmZWRiMjEzIiwiaWF0IjoxNTE4NTMyMzYzLCJhdF9oYXNoIjoiMXNCMWxlNnlxTnlmbTNEOVhJaGNLQSIsInNpZCI6IjNkMDhiYTQwM2M5NDZmZjJkZGQxZjNkYjQxZTE4M2Y2Iiwic3ViIjoiOGFlMjRhMjgtNTlmNS00OGE2LTkyYzYtYzZjYWM1NTEzNDFiIiwiYXV0aF90aW1lIjoxNTE4NTMyMzU5LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.fkX_FQxQwb0tVYax6Eg6uhlbO3Di_W9DCA0LvCJXSH5G47KPmjbOZA5x0lUfcqCDvGttiLazXpslVj4II-MXXCjxSW0A0ldUBRU5njQQkYNntphyLILGOlMs5mgI93lBv3C9pMLVdIMHhnSLimPsFttO36Cako5nAGQkBxeheMEsPFyJnmlnC6X0ngXR4l61w0mY8Bd1Yjv_taxQmbFyMbDc9BC2fPBiM4bgM2ho0bbbHfib_WF7PfYCpqf0YSXJASEMRCCFNZ3WpqCVxbAPBWoKa4dv4VYAfcZv54I58d8Vk4hbtvBys3cRwhEwIQRnMLnqPUU8un4NjGXooMv0-g",
    "post_logout_redirect_uri": "http://localhost:5003/index.html"
  }
}
2018-02-13 09:33:11.333 -05:00 [DBG] Success validating end session request from js
2018-02-13 09:33:11.390 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:33:11.401 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:33:11.603 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-02-13 09:33:11.613 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-13 09:33:11.623 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-02-13 09:33:11.632 -05:00 [INF] User logged out.
2018-02-13 09:33:12.041 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-13 09:33:12.060 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-13 09:33:12.068 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-13 09:33:12.099 -05:00 [DBG] Processing signout callback request
2018-02-13 09:33:12.708 -05:00 [DBG] js found in database: true
2018-02-13 09:33:12.717 -05:00 [DBG] No client front-channel logout URLs
2018-02-13 09:33:12.721 -05:00 [DBG] No client back-channel logout URLs
2018-02-13 09:33:12.727 -05:00 [INF] Successful signout callback.
2018-02-13 09:33:12.735 -05:00 [DBG] No client front-channel iframe urls
2018-02-13 09:33:12.739 -05:00 [DBG] No client back-channel iframe urls
2018-02-13 09:38:54.011 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-13 09:38:54.093 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-13 09:38:54.098 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-13 09:38:54.101 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-13 09:38:54.105 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-13 09:39:33.882 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:39:34.896 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:39:34.911 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:39:35.031 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:39:35.080 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:39:35.088 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:39:35.104 -05:00 [DBG] Start discovery request
2018-02-13 09:39:36.556 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:39:36.775 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-13 09:39:36.883 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-13 09:39:36.888 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-13 09:39:36.903 -05:00 [DBG] Start authorize request
2018-02-13 09:39:36.930 -05:00 [DBG] No user present in authorize request
2018-02-13 09:39:36.956 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:39:38.161 -05:00 [DBG] js found in database: true
2018-02-13 09:39:38.362 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:39:38.707 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:39:38.862 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:39:39.151 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:39:39.180 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:39:39.237 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ade14816303f49cc8efdfaad5ba082ef",
  "Nonce": "7455b62e7ebf4112a8cdcef37d1069d9",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "ade14816303f49cc8efdfaad5ba082ef",
    "nonce": "7455b62e7ebf4112a8cdcef37d1069d9"
  }
}
2018-02-13 09:39:39.263 -05:00 [INF] Showing login: User is not authenticated
2018-02-13 09:39:39.880 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-13 09:39:39.910 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:39:40.645 -05:00 [DBG] js found in database: true
2018-02-13 09:39:40.783 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:39:41.127 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:39:41.269 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:39:41.621 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:39:41.629 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:40:04.083 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:40:04.092 -05:00 [DBG] Adding idp claim with value: local
2018-02-13 09:40:04.097 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-13 09:40:04.102 -05:00 [DBG] Adding auth_time claim with value: 1518532804
2018-02-13 09:40:04.121 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:40:04.131 -05:00 [INF] User logged in.
2018-02-13 09:40:04.180 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:40:04.189 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:40:04.197 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-13 09:40:04.204 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-13 09:40:04.209 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-13 09:40:04.229 -05:00 [DBG] Start authorize callback request
2018-02-13 09:40:04.242 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:40:04.247 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:40:05.442 -05:00 [DBG] js found in database: true
2018-02-13 09:40:05.668 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:40:06.207 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:40:06.433 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:40:06.987 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:40:06.994 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:40:07.001 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ade14816303f49cc8efdfaad5ba082ef",
  "Nonce": "7455b62e7ebf4112a8cdcef37d1069d9",
  "SessionId": "7c429bae40faec26a45e8d97b92a2129",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "ade14816303f49cc8efdfaad5ba082ef",
    "nonce": "7455b62e7ebf4112a8cdcef37d1069d9"
  }
}
2018-02-13 09:40:07.238 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-13 09:40:07.257 -05:00 [DBG] Creating Implicit Flow response.
2018-02-13 09:40:07.284 -05:00 [DBG] Getting claims for access token for client: js
2018-02-13 09:40:07.289 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:40:07.664 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-13 09:40:07.670 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-13 09:40:07.707 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "ade14816303f49cc8efdfaad5ba082ef",
  "Scope": "openid profile api1"
}
2018-02-13 09:40:07.762 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:40:07.768 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:40:08.288 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:40:08.359 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:40:08.364 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:40:08.375 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:40:08.385 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:40:08.390 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:40:08.401 -05:00 [DBG] Start discovery request
2018-02-13 09:40:08.789 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:40:08.821 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-13 09:40:08.889 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:40:08.896 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:40:08.907 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-13 09:40:08.914 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-13 09:40:08.919 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-13 09:40:08.934 -05:00 [DBG] Start key discovery request
2018-02-13 09:40:09.031 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:40:09.087 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:40:09.093 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:40:09.125 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:40:09.181 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:40:09.188 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:40:09.198 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-13 09:40:09.209 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-13 09:40:09.214 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-13 09:40:09.243 -05:00 [DBG] Start userinfo request
2018-02-13 09:40:09.254 -05:00 [DBG] Bearer token found in header
2018-02-13 09:40:09.959 -05:00 [DBG] js found in database: true
2018-02-13 09:40:10.519 -05:00 [DBG] js found in database: true
2018-02-13 09:40:10.598 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-13 09:40:10.618 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518532807,
    "exp": 1518536407,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518532804,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-13 09:40:10.639 -05:00 [DBG] Creating userinfo response
2018-02-13 09:40:10.655 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:40:10.665 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:40:10.780 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:40:10.788 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-13 09:40:10.794 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:40:10.885 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:40:11.027 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-13 09:40:11.037 -05:00 [DBG] End userinfo request
2018-02-13 09:40:11.076 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:40:11.099 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:40:11.127 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-13 09:40:11.134 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-13 09:40:11.142 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-13 09:40:11.155 -05:00 [DBG] Rendering check session result
2018-02-13 09:40:11.359 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:40:11.428 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:40:11.434 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:40:11.445 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:40:11.454 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:40:11.460 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:40:11.469 -05:00 [DBG] Start discovery request
2018-02-13 09:40:11.835 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:42:50.563 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-13 09:42:50.662 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-13 09:42:50.667 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-13 09:42:50.670 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-13 09:42:50.674 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-13 09:43:33.702 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:43:34.737 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:43:34.752 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:43:34.878 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:43:34.921 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:43:34.927 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:43:34.940 -05:00 [DBG] Start discovery request
2018-02-13 09:43:36.392 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:43:36.632 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-13 09:43:36.739 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-13 09:43:36.744 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-13 09:43:36.762 -05:00 [DBG] Start authorize request
2018-02-13 09:43:36.793 -05:00 [DBG] No user present in authorize request
2018-02-13 09:43:36.822 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:43:38.012 -05:00 [DBG] js found in database: true
2018-02-13 09:43:38.208 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:43:38.576 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:43:38.726 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:43:39.017 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:43:39.051 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:43:39.129 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "e9a23f1a09e94fc08f28b6e90f66f3fa",
  "Nonce": "2811ee4788cd488fa6bd73471efcf6a8",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "e9a23f1a09e94fc08f28b6e90f66f3fa",
    "nonce": "2811ee4788cd488fa6bd73471efcf6a8"
  }
}
2018-02-13 09:43:39.165 -05:00 [INF] Showing login: User is not authenticated
2018-02-13 09:43:39.772 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-13 09:43:39.801 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:43:40.507 -05:00 [DBG] js found in database: true
2018-02-13 09:43:40.650 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:43:41.015 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:43:41.164 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:43:41.521 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:43:41.532 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:44:00.643 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:44:00.655 -05:00 [DBG] Adding idp claim with value: local
2018-02-13 09:44:00.660 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-13 09:44:00.666 -05:00 [DBG] Adding auth_time claim with value: 1518533040
2018-02-13 09:44:00.688 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:44:00.696 -05:00 [INF] User logged in.
2018-02-13 09:44:00.754 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:44:00.761 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:44:00.770 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-13 09:44:00.791 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-13 09:44:00.796 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-13 09:44:00.815 -05:00 [DBG] Start authorize callback request
2018-02-13 09:44:00.828 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:44:00.833 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:44:02.032 -05:00 [DBG] js found in database: true
2018-02-13 09:44:02.261 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:44:02.823 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:44:03.058 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:44:03.637 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:44:03.645 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:44:03.651 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "e9a23f1a09e94fc08f28b6e90f66f3fa",
  "Nonce": "2811ee4788cd488fa6bd73471efcf6a8",
  "SessionId": "495eb1078ecc0f54d0a68affa26a2e13",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "e9a23f1a09e94fc08f28b6e90f66f3fa",
    "nonce": "2811ee4788cd488fa6bd73471efcf6a8"
  }
}
2018-02-13 09:44:03.879 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-13 09:44:03.899 -05:00 [DBG] Creating Implicit Flow response.
2018-02-13 09:44:03.925 -05:00 [DBG] Getting claims for access token for client: js
2018-02-13 09:44:03.930 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:44:04.294 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-13 09:44:04.301 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-13 09:44:04.351 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "e9a23f1a09e94fc08f28b6e90f66f3fa",
  "Scope": "openid profile api1"
}
2018-02-13 09:44:04.401 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:44:04.406 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:44:04.931 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:44:04.996 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:44:05.002 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:44:05.013 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:44:05.021 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:44:05.026 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:44:05.035 -05:00 [DBG] Start discovery request
2018-02-13 09:44:05.428 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:44:05.455 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-13 09:44:05.509 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:44:05.515 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:44:05.527 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-13 09:44:05.537 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-13 09:44:05.543 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-13 09:44:05.559 -05:00 [DBG] Start key discovery request
2018-02-13 09:44:05.655 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:44:05.707 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:44:05.713 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:44:05.747 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:44:05.801 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:44:05.809 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:44:05.824 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-13 09:44:05.838 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-13 09:44:05.844 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-13 09:44:05.869 -05:00 [DBG] Start userinfo request
2018-02-13 09:44:05.882 -05:00 [DBG] Bearer token found in header
2018-02-13 09:44:06.619 -05:00 [DBG] js found in database: true
2018-02-13 09:44:07.213 -05:00 [DBG] js found in database: true
2018-02-13 09:44:07.292 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-13 09:44:07.312 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518533044,
    "exp": 1518536644,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518533040,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-13 09:44:07.333 -05:00 [DBG] Creating userinfo response
2018-02-13 09:44:07.350 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:44:07.361 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:44:07.544 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:44:07.551 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-13 09:44:07.558 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:44:07.726 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:44:07.907 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-13 09:44:07.916 -05:00 [DBG] End userinfo request
2018-02-13 09:44:07.951 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:44:07.966 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:44:07.984 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-13 09:44:07.992 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-13 09:44:07.998 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-13 09:44:08.010 -05:00 [DBG] Rendering check session result
2018-02-13 09:44:08.254 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:44:08.319 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:44:08.325 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:44:08.338 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:44:08.348 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:44:08.357 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:44:08.366 -05:00 [DBG] Start discovery request
2018-02-13 09:44:08.740 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:44:47.752 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:44:47.773 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:44:47.796 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-13 09:44:47.804 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-13 09:44:47.843 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-13 09:44:47.853 -05:00 [DBG] Rendering check session result
2018-02-13 09:44:48.343 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:44:48.350 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:44:48.357 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:44:48.366 -05:00 [DBG] Start discovery request
2018-02-13 09:44:48.743 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:44:49.285 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-13 09:44:49.291 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-13 09:44:49.297 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-13 09:44:49.307 -05:00 [DBG] Start key discovery request
2018-02-13 09:46:44.891 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-13 09:46:44.974 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-13 09:46:44.978 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-13 09:46:44.982 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-13 09:46:45.005 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-13 09:47:14.859 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:47:15.873 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:47:15.888 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:47:16.013 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:47:16.050 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:47:16.055 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:47:16.068 -05:00 [DBG] Start discovery request
2018-02-13 09:47:17.474 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:47:17.699 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-13 09:47:17.808 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-13 09:47:17.814 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-13 09:47:17.832 -05:00 [DBG] Start authorize request
2018-02-13 09:47:17.857 -05:00 [DBG] No user present in authorize request
2018-02-13 09:47:17.884 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:47:19.043 -05:00 [DBG] js found in database: true
2018-02-13 09:47:19.241 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:47:19.595 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:47:19.739 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:47:20.009 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:47:20.032 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:47:20.089 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "dcc186c4ab8e4294b1e3c9bd95a5dd32",
  "Nonce": "e1434361355846fa828886adc6b1f6a6",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "dcc186c4ab8e4294b1e3c9bd95a5dd32",
    "nonce": "e1434361355846fa828886adc6b1f6a6"
  }
}
2018-02-13 09:47:20.115 -05:00 [INF] Showing login: User is not authenticated
2018-02-13 09:47:20.713 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-13 09:47:20.744 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:47:21.440 -05:00 [DBG] js found in database: true
2018-02-13 09:47:21.590 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:47:21.952 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:47:22.096 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:47:22.465 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:47:22.475 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:47:42.158 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:47:42.166 -05:00 [DBG] Adding idp claim with value: local
2018-02-13 09:47:42.170 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-13 09:47:42.175 -05:00 [DBG] Adding auth_time claim with value: 1518533262
2018-02-13 09:47:42.194 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:47:42.204 -05:00 [INF] User logged in.
2018-02-13 09:47:42.262 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:47:42.272 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:47:42.281 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-13 09:47:42.289 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-13 09:47:42.296 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-13 09:47:42.316 -05:00 [DBG] Start authorize callback request
2018-02-13 09:47:42.328 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:47:42.332 -05:00 [DBG] Start authorize request protocol validation
2018-02-13 09:47:43.421 -05:00 [DBG] js found in database: true
2018-02-13 09:47:43.645 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:47:44.173 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:47:44.391 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:47:44.915 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-13 09:47:44.922 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-13 09:47:44.929 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "dcc186c4ab8e4294b1e3c9bd95a5dd32",
  "Nonce": "e1434361355846fa828886adc6b1f6a6",
  "SessionId": "47633b759f51d6b796fb83529324576c",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "dcc186c4ab8e4294b1e3c9bd95a5dd32",
    "nonce": "e1434361355846fa828886adc6b1f6a6"
  }
}
2018-02-13 09:47:45.139 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-13 09:47:45.157 -05:00 [DBG] Creating Implicit Flow response.
2018-02-13 09:47:45.185 -05:00 [DBG] Getting claims for access token for client: js
2018-02-13 09:47:45.190 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:47:45.563 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-13 09:47:45.569 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-13 09:47:45.606 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "dcc186c4ab8e4294b1e3c9bd95a5dd32",
  "Scope": "openid profile api1"
}
2018-02-13 09:47:45.653 -05:00 [DBG] Augmenting SignInContext
2018-02-13 09:47:45.658 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-13 09:47:46.093 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:47:46.156 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:47:46.163 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:47:46.175 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:47:46.182 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:47:46.189 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:47:46.197 -05:00 [DBG] Start discovery request
2018-02-13 09:47:46.563 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:47:46.588 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-13 09:47:46.642 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:47:46.648 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:47:46.658 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-13 09:47:46.665 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-13 09:47:46.670 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-13 09:47:46.686 -05:00 [DBG] Start key discovery request
2018-02-13 09:47:46.768 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:47:46.822 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:47:46.828 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:47:46.858 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-13 09:47:46.919 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:47:46.926 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:47:46.937 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-13 09:47:46.949 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-13 09:47:46.954 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-13 09:47:46.974 -05:00 [DBG] Start userinfo request
2018-02-13 09:47:46.985 -05:00 [DBG] Bearer token found in header
2018-02-13 09:47:47.679 -05:00 [DBG] js found in database: true
2018-02-13 09:47:48.206 -05:00 [DBG] js found in database: true
2018-02-13 09:47:48.281 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-13 09:47:48.299 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518533265,
    "exp": 1518536865,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518533262,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-13 09:47:48.318 -05:00 [DBG] Creating userinfo response
2018-02-13 09:47:48.330 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:47:48.342 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:47:48.459 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:47:48.466 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-13 09:47:48.473 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-13 09:47:48.558 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-13 09:47:48.687 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-13 09:47:48.695 -05:00 [DBG] End userinfo request
2018-02-13 09:47:48.726 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:47:48.736 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:47:48.747 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-13 09:47:48.756 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-13 09:47:48.762 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-13 09:47:48.775 -05:00 [DBG] Rendering check session result
2018-02-13 09:47:48.987 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-13 09:47:49.063 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-13 09:47:49.070 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-13 09:47:49.083 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:47:49.091 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:47:49.102 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:47:49.116 -05:00 [DBG] Start discovery request
2018-02-13 09:47:49.580 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:47:49.606 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:47:49.613 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:47:49.623 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-13 09:47:49.629 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-13 09:47:49.635 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-13 09:47:49.644 -05:00 [DBG] Rendering check session result
2018-02-13 09:47:49.724 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-13 09:47:49.728 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-13 09:47:49.733 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-13 09:47:49.740 -05:00 [DBG] Start discovery request
2018-02-13 09:47:50.097 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-13 09:47:50.561 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-13 09:47:50.567 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-13 09:47:50.572 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-13 09:47:50.581 -05:00 [DBG] Start key discovery request
2018-02-13 09:48:13.585 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:48:13.597 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:48:13.606 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-13 09:48:13.614 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-13 09:48:13.620 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-13 09:48:13.637 -05:00 [DBG] Processing signout request for 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-13 09:48:13.655 -05:00 [DBG] Start end session request validation
2018-02-13 09:48:13.670 -05:00 [DBG] Start identity token validation
2018-02-13 09:48:14.214 -05:00 [DBG] js found in database: true
2018-02-13 09:48:14.222 -05:00 [DBG] Client found: js / js.client
2018-02-13 09:48:14.313 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-13 09:48:14.325 -05:00 [DBG] Token validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1518533265,
    "exp": 1518533565,
    "iss": "http://localhost:5000",
    "aud": "js",
    "nonce": "e1434361355846fa828886adc6b1f6a6",
    "iat": 1518533265,
    "at_hash": "2ESc75jvqE413w6UJeUorA",
    "sid": "47633b759f51d6b796fb83529324576c",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518533262,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-02-13 09:48:14.348 -05:00 [INF] End session request validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "PostLogOutUri": "http://localhost:5003/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjY3NTYzMGI1NWQ3NWE3OTI4MmNmZWI2OGNiN2I2MDZmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTg1MzMyNjUsImV4cCI6MTUxODUzMzU2NSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoianMiLCJub25jZSI6ImUxNDM0MzYxMzU1ODQ2ZmE4Mjg4ODZhZGM2YjFmNmE2IiwiaWF0IjoxNTE4NTMzMjY1LCJhdF9oYXNoIjoiMkVTYzc1anZxRTQxM3c2VUplVW9yQSIsInNpZCI6IjQ3NjMzYjc1OWY1MWQ2Yjc5NmZiODM1MjkzMjQ1NzZjIiwic3ViIjoiOGFlMjRhMjgtNTlmNS00OGE2LTkyYzYtYzZjYWM1NTEzNDFiIiwiYXV0aF90aW1lIjoxNTE4NTMzMjYyLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.Y5F5nNZl6wFLbjXPw4c36WqEb5vAHs9scoy5NBZ37WV4vkoQg5cFRCB_v_KgvHY3vNVwrpxABvv9a-m_vXpBsaqPFBPBe7Kso3ccJguGJTTU-8AqP3kvfHHi5RTWJpFznBIguatGinnPTYZWpADpNN8d_MzL3Wl4aGTlcEgYJ4EbCrI_6JtJiDjUnaz5ejfo6d4oTQfKlaQTWU07HRpSgIgMi_7xsA8TydWmYTW2tZMpyhjIeKCnGe41_B0422nL3korZkGTvBKwhbHe_7_KC7wJe7j2MmsENEucfD2v1FJKam5_xDTWfpzA0WZGJZBCTLpRIZohsntvxEQOCA_RtQ",
    "post_logout_redirect_uri": "http://localhost:5003/index.html"
  }
}
2018-02-13 09:48:14.361 -05:00 [DBG] Success validating end session request from js
2018-02-13 09:48:14.414 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:48:14.425 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-13 09:48:14.600 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-02-13 09:48:14.610 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-13 09:48:14.620 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-02-13 09:48:14.630 -05:00 [INF] User logged out.
2018-02-13 09:48:15.145 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-13 09:48:15.164 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-13 09:48:15.176 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-13 09:48:15.206 -05:00 [DBG] Processing signout callback request
2018-02-13 09:48:15.817 -05:00 [DBG] js found in database: true
2018-02-13 09:48:15.825 -05:00 [DBG] No client front-channel logout URLs
2018-02-13 09:48:15.831 -05:00 [DBG] No client back-channel logout URLs
2018-02-13 09:48:15.838 -05:00 [INF] Successful signout callback.
2018-02-13 09:48:15.848 -05:00 [DBG] No client front-channel iframe urls
2018-02-13 09:48:15.854 -05:00 [DBG] No client back-channel iframe urls
