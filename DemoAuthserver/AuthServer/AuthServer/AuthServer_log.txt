2018-02-09 13:37:41.253 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-09 13:37:41.338 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-09 13:37:41.342 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-09 13:37:41.346 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-09 13:37:41.349 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-09 13:38:20.503 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 13:38:21.589 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:38:21.604 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:38:21.729 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 13:38:21.778 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 13:38:21.785 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 13:38:21.801 -05:00 [DBG] Start discovery request
2018-02-09 13:38:23.306 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 13:38:23.535 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-09 13:38:23.635 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-09 13:38:23.640 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-09 13:38:23.658 -05:00 [DBG] Start authorize request
2018-02-09 13:38:23.687 -05:00 [DBG] No user present in authorize request
2018-02-09 13:38:23.714 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 13:38:24.970 -05:00 [DBG] js found in database: true
2018-02-09 13:38:25.192 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:38:25.629 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:38:25.797 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:38:26.099 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:38:26.136 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 13:38:26.200 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "2e1163f138514b2ab6d9b3da5cca4a03",
  "Nonce": "d5a791d91e664b28a021b589307cc6a9",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "2e1163f138514b2ab6d9b3da5cca4a03",
    "nonce": "d5a791d91e664b28a021b589307cc6a9"
  }
}
2018-02-09 13:38:26.232 -05:00 [INF] Showing login: User is not authenticated
2018-02-09 13:38:26.881 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 13:38:26.913 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 13:38:27.728 -05:00 [DBG] js found in database: true
2018-02-09 13:38:27.883 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:38:28.250 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:38:28.408 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:38:28.788 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:38:28.796 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 13:38:57.996 -05:00 [DBG] Augmenting SignInContext
2018-02-09 13:38:58.004 -05:00 [DBG] Adding idp claim with value: local
2018-02-09 13:38:58.008 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-09 13:38:58.016 -05:00 [DBG] Adding auth_time claim with value: 1518201538
2018-02-09 13:38:58.040 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 13:38:58.049 -05:00 [INF] User logged in.
2018-02-09 13:38:58.109 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:38:58.119 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:38:58.129 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-09 13:38:58.136 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-09 13:38:58.143 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-09 13:38:58.163 -05:00 [DBG] Start authorize callback request
2018-02-09 13:38:58.179 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 13:38:58.184 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 13:38:59.378 -05:00 [DBG] js found in database: true
2018-02-09 13:38:59.598 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:39:00.165 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:39:00.406 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:39:01.020 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 13:39:01.032 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 13:39:01.037 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "2e1163f138514b2ab6d9b3da5cca4a03",
  "Nonce": "d5a791d91e664b28a021b589307cc6a9",
  "SessionId": "f80b09fa34fe67f90117912fb01ee854",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "2e1163f138514b2ab6d9b3da5cca4a03",
    "nonce": "d5a791d91e664b28a021b589307cc6a9"
  }
}
2018-02-09 13:39:01.263 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-09 13:39:01.284 -05:00 [DBG] Creating Implicit Flow response.
2018-02-09 13:39:01.311 -05:00 [DBG] Getting claims for access token for client: js
2018-02-09 13:39:01.317 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 13:39:01.722 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-09 13:39:01.729 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-09 13:39:01.775 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "2e1163f138514b2ab6d9b3da5cca4a03",
  "Scope": "openid profile api1"
}
2018-02-09 13:39:01.824 -05:00 [DBG] Augmenting SignInContext
2018-02-09 13:39:01.829 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 13:39:02.256 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 13:39:02.334 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:39:02.340 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:39:02.362 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 13:39:02.372 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 13:39:02.392 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 13:39:02.416 -05:00 [DBG] Start discovery request
2018-02-09 13:39:02.852 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 13:39:02.879 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-09 13:39:02.934 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:39:02.940 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:39:02.950 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 13:39:02.957 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 13:39:02.962 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 13:39:02.980 -05:00 [DBG] Start key discovery request
2018-02-09 13:39:03.093 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 13:39:03.148 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:39:03.154 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:39:03.192 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 13:39:03.250 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:39:03.257 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:39:03.273 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-09 13:39:03.289 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-09 13:39:03.296 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-09 13:39:03.318 -05:00 [DBG] Start userinfo request
2018-02-09 13:39:03.330 -05:00 [DBG] Bearer token found in header
2018-02-09 13:39:04.059 -05:00 [DBG] js found in database: true
2018-02-09 13:39:04.621 -05:00 [DBG] js found in database: true
2018-02-09 13:39:04.702 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 13:39:04.722 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518201541,
    "exp": 1518205141,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518201538,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-09 13:39:04.745 -05:00 [DBG] Creating userinfo response
2018-02-09 13:39:04.761 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 13:39:04.773 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 13:39:04.896 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:39:04.905 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-09 13:39:04.911 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 13:39:05.006 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 13:39:05.139 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-09 13:39:05.149 -05:00 [DBG] End userinfo request
2018-02-09 13:39:05.200 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:39:05.217 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:39:05.228 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 13:39:05.237 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 13:39:05.244 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 13:39:05.255 -05:00 [DBG] Rendering check session result
2018-02-09 13:39:05.538 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 13:39:05.608 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 13:39:05.613 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 13:39:05.624 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 13:39:05.632 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 13:39:05.637 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 13:39:05.646 -05:00 [DBG] Start discovery request
2018-02-09 13:39:06.042 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 13:39:06.082 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:39:06.092 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 13:39:06.102 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 13:39:06.108 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 13:39:06.114 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 13:39:06.125 -05:00 [DBG] Rendering check session result
2018-02-09 13:39:13.278 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 13:39:13.284 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 13:39:13.290 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 13:39:13.298 -05:00 [DBG] Start discovery request
2018-02-09 13:39:13.703 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 13:39:14.217 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 13:39:14.223 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 13:39:14.229 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 13:39:14.238 -05:00 [DBG] Start key discovery request
2018-02-09 14:08:05.810 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-09 14:08:05.893 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-09 14:08:05.897 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-09 14:08:05.901 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-09 14:08:05.905 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-09 14:12:44.786 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:12:44.838 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:12:44.844 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:12:44.860 -05:00 [DBG] Start discovery request
2018-02-09 14:12:47.228 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:12:48.002 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:12:48.084 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:12:48.089 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:12:48.104 -05:00 [DBG] Start key discovery request
2018-02-09 14:12:48.391 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-09 14:12:48.418 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-09 14:12:48.425 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-09 14:12:48.447 -05:00 [DBG] Start authorize request
2018-02-09 14:12:48.480 -05:00 [DBG] No user present in authorize request
2018-02-09 14:12:48.498 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:12:49.678 -05:00 [DBG] mvc found in database: true
2018-02-09 14:12:49.697 -05:00 [DBG] Checking for PKCE parameters
2018-02-09 14:12:49.704 -05:00 [DBG] No PKCE used.
2018-02-09 14:12:49.906 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:12:50.265 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:12:50.420 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:12:50.733 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:12:50.763 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:12:50.806 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1.APIScope",
  "State": "CfDJ8O7BMrsJqQNKq-OZZwepkQ1JjDcHR3R2KHS9rDrZMkQRDodAlhaHHcZOdx1-txgwp8wYpvsR4N2NtQUd1vwQiudVSinP7ZZ6yB-J2iZ6y4hgEk0QYBBHterxxx68P8b_Jy3XxxrTG2jl-iFbJkS6_sOPk1RBqhEooUFdVq3EnfROkj0ZgefHGrqjZi1xfmWMzEDUdD1uEm5ddv2BuWUbq0TByZYx73ev_Df-xIOIibE6NfNUc1BsNjntDU-Gvc9qXqDIQ7oTarBkQD6Y1DU-44NN25ZxU_qtcz0NSshgY35IYuJO2wiaykpHUaJt_eN22D0jLwTitv4fKlo35O76azI",
  "Nonce": "636538003682779179.ODA4MmY3MDctYmE4Zi00NWY4LTk0MmEtNWZmMDZiOTdkMWEyZjU2NjViMGEtOTM2Yy00ZmYyLWExNjEtNjZmYWNiMTU1ZDFm",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1.APIScope",
    "response_mode": "form_post",
    "nonce": "636538003682779179.ODA4MmY3MDctYmE4Zi00NWY4LTk0MmEtNWZmMDZiOTdkMWEyZjU2NjViMGEtOTM2Yy00ZmYyLWExNjEtNjZmYWNiMTU1ZDFm",
    "state": "CfDJ8O7BMrsJqQNKq-OZZwepkQ1JjDcHR3R2KHS9rDrZMkQRDodAlhaHHcZOdx1-txgwp8wYpvsR4N2NtQUd1vwQiudVSinP7ZZ6yB-J2iZ6y4hgEk0QYBBHterxxx68P8b_Jy3XxxrTG2jl-iFbJkS6_sOPk1RBqhEooUFdVq3EnfROkj0ZgefHGrqjZi1xfmWMzEDUdD1uEm5ddv2BuWUbq0TByZYx73ev_Df-xIOIibE6NfNUc1BsNjntDU-Gvc9qXqDIQ7oTarBkQD6Y1DU-44NN25ZxU_qtcz0NSshgY35IYuJO2wiaykpHUaJt_eN22D0jLwTitv4fKlo35O76azI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-02-09 14:12:50.845 -05:00 [INF] Showing login: User is not authenticated
2018-02-09 14:12:51.430 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 14:12:51.469 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:12:52.182 -05:00 [DBG] mvc found in database: true
2018-02-09 14:12:52.190 -05:00 [DBG] Checking for PKCE parameters
2018-02-09 14:12:52.195 -05:00 [DBG] No PKCE used.
2018-02-09 14:12:52.336 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:12:52.695 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:12:52.843 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:12:53.204 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:12:53.212 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:13:26.976 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:13:26.985 -05:00 [DBG] Adding idp claim with value: local
2018-02-09 14:13:26.990 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-09 14:13:26.995 -05:00 [DBG] Adding auth_time claim with value: 1518203606
2018-02-09 14:13:27.021 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:13:27.036 -05:00 [INF] User logged in.
2018-02-09 14:13:27.096 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:13:27.105 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:13:27.114 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-09 14:13:27.123 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-09 14:13:27.128 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-09 14:13:27.147 -05:00 [DBG] Start authorize callback request
2018-02-09 14:13:27.160 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:13:27.165 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:13:28.306 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:28.315 -05:00 [DBG] Checking for PKCE parameters
2018-02-09 14:13:28.319 -05:00 [DBG] No PKCE used.
2018-02-09 14:13:28.558 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:29.130 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:29.357 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:29.913 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:29.923 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:13:29.930 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1.APIScope",
  "State": "CfDJ8O7BMrsJqQNKq-OZZwepkQ1JjDcHR3R2KHS9rDrZMkQRDodAlhaHHcZOdx1-txgwp8wYpvsR4N2NtQUd1vwQiudVSinP7ZZ6yB-J2iZ6y4hgEk0QYBBHterxxx68P8b_Jy3XxxrTG2jl-iFbJkS6_sOPk1RBqhEooUFdVq3EnfROkj0ZgefHGrqjZi1xfmWMzEDUdD1uEm5ddv2BuWUbq0TByZYx73ev_Df-xIOIibE6NfNUc1BsNjntDU-Gvc9qXqDIQ7oTarBkQD6Y1DU-44NN25ZxU_qtcz0NSshgY35IYuJO2wiaykpHUaJt_eN22D0jLwTitv4fKlo35O76azI",
  "Nonce": "636538003682779179.ODA4MmY3MDctYmE4Zi00NWY4LTk0MmEtNWZmMDZiOTdkMWEyZjU2NjViMGEtOTM2Yy00ZmYyLWExNjEtNjZmYWNiMTU1ZDFm",
  "SessionId": "1d6041be80178d5e08717d748507a54d",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1.APIScope",
    "response_mode": "form_post",
    "nonce": "636538003682779179.ODA4MmY3MDctYmE4Zi00NWY4LTk0MmEtNWZmMDZiOTdkMWEyZjU2NjViMGEtOTM2Yy00ZmYyLWExNjEtNjZmYWNiMTU1ZDFm",
    "state": "CfDJ8O7BMrsJqQNKq-OZZwepkQ1JjDcHR3R2KHS9rDrZMkQRDodAlhaHHcZOdx1-txgwp8wYpvsR4N2NtQUd1vwQiudVSinP7ZZ6yB-J2iZ6y4hgEk0QYBBHterxxx68P8b_Jy3XxxrTG2jl-iFbJkS6_sOPk1RBqhEooUFdVq3EnfROkj0ZgefHGrqjZi1xfmWMzEDUdD1uEm5ddv2BuWUbq0TByZYx73ev_Df-xIOIibE6NfNUc1BsNjntDU-Gvc9qXqDIQ7oTarBkQD6Y1DU-44NN25ZxU_qtcz0NSshgY35IYuJO2wiaykpHUaJt_eN22D0jLwTitv4fKlo35O76azI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-02-09 14:13:30.172 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-09 14:13:30.188 -05:00 [DBG] Creating Hybrid Flow response.
2018-02-09 14:13:30.376 -05:00 [DBG] OOucvgG30xymJopJb1uz2p5UOL6hQiNvi58FB0r6lOQ= not found in database
2018-02-09 14:13:30.529 -05:00 [DBG] Creating Implicit Flow response.
2018-02-09 14:13:30.558 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: mvc
2018-02-09 14:13:30.913 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8O7BMrsJqQNKq-OZZwepkQ1JjDcHR3R2KHS9rDrZMkQRDodAlhaHHcZOdx1-txgwp8wYpvsR4N2NtQUd1vwQiudVSinP7ZZ6yB-J2iZ6y4hgEk0QYBBHterxxx68P8b_Jy3XxxrTG2jl-iFbJkS6_sOPk1RBqhEooUFdVq3EnfROkj0ZgefHGrqjZi1xfmWMzEDUdD1uEm5ddv2BuWUbq0TByZYx73ev_Df-xIOIibE6NfNUc1BsNjntDU-Gvc9qXqDIQ7oTarBkQD6Y1DU-44NN25ZxU_qtcz0NSshgY35IYuJO2wiaykpHUaJt_eN22D0jLwTitv4fKlo35O76azI",
  "Scope": "openid profile api1.APIScope"
}
2018-02-09 14:13:30.968 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:13:30.974 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:13:31.310 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-02-09 14:13:31.327 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-02-09 14:13:31.333 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-02-09 14:13:31.365 -05:00 [DBG] Start token request.
2018-02-09 14:13:31.389 -05:00 [DBG] Start client validation
2018-02-09 14:13:31.405 -05:00 [DBG] Start parsing Basic Authentication secret
2018-02-09 14:13:31.416 -05:00 [DBG] Start parsing for secret in post body
2018-02-09 14:13:31.422 -05:00 [DBG] Parser found secret: PostBodySecretParser
2018-02-09 14:13:31.427 -05:00 [DBG] Secret id found: mvc
2018-02-09 14:13:32.078 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:32.102 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-02-09 14:13:32.107 -05:00 [DBG] Client validation success
2018-02-09 14:13:32.124 -05:00 [DBG] Start token request validation
2018-02-09 14:13:32.155 -05:00 [DBG] Start validation of authorization code token request
2018-02-09 14:13:32.272 -05:00 [DBG] OOucvgG30xymJopJb1uz2p5UOL6hQiNvi58FB0r6lOQ= found in database: true
2018-02-09 14:13:32.410 -05:00 [DBG] removing OOucvgG30xymJopJb1uz2p5UOL6hQiNvi58FB0r6lOQ= persisted grant from database
2018-02-09 14:13:32.565 -05:00 [DBG] Validation of authorization code token request success
2018-02-09 14:13:32.589 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "4d782b720d311e9feb3cd45f218974993cdd11b80e2bec7499dba7a60bece90e",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "4d782b720d311e9feb3cd45f218974993cdd11b80e2bec7499dba7a60bece90e",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-02-09 14:13:33.470 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:33.633 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:34.037 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:34.073 -05:00 [DBG] Getting claims for access token for client: mvc
2018-02-09 14:13:34.079 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:13:35.070 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:35.235 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:35.648 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:35.657 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: mvc
2018-02-09 14:13:35.834 -05:00 [DBG] Token request success.
2018-02-09 14:13:35.951 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-09 14:13:35.961 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-09 14:13:35.966 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-09 14:13:35.987 -05:00 [DBG] Start userinfo request
2018-02-09 14:13:35.997 -05:00 [DBG] Bearer token found in header
2018-02-09 14:13:36.728 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:37.295 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:37.381 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 14:13:37.397 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518203614,
    "exp": 1518207214,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518203606,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1.APIScope"
    ],
    "amr": "pwd"
  }
}
2018-02-09 14:13:37.422 -05:00 [DBG] Creating userinfo response
2018-02-09 14:13:37.434 -05:00 [DBG] Scopes in access token: openid profile api1.APIScope
2018-02-09 14:13:37.446 -05:00 [DBG] Scopes in access token: openid profile api1.APIScope
2018-02-09 14:13:37.625 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:37.638 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-09 14:13:37.643 -05:00 [DBG] Scopes in access token: openid profile api1.APIScope
2018-02-09 14:13:37.795 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:13:37.963 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-09 14:13:37.975 -05:00 [DBG] End userinfo request
2018-02-09 14:13:43.781 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:13:43.788 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:13:43.795 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:13:43.806 -05:00 [DBG] Start discovery request
2018-02-09 14:13:44.202 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:13:44.707 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:13:44.715 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:13:44.722 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:13:44.732 -05:00 [DBG] Start key discovery request
2018-02-09 14:13:56.236 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:13:56.243 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:13:56.249 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:13:56.258 -05:00 [DBG] Start discovery request
2018-02-09 14:13:56.642 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:13:56.749 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:13:56.757 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:13:56.763 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:13:56.775 -05:00 [DBG] Start key discovery request
2018-02-09 14:13:56.920 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-02-09 14:13:56.927 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-02-09 14:13:56.934 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-02-09 14:13:56.963 -05:00 [DBG] Start token request.
2018-02-09 14:13:56.969 -05:00 [DBG] Start client validation
2018-02-09 14:13:56.975 -05:00 [DBG] Start parsing Basic Authentication secret
2018-02-09 14:13:56.981 -05:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-02-09 14:13:56.990 -05:00 [DBG] Secret id found: mvc
2018-02-09 14:13:57.569 -05:00 [DBG] mvc found in database: true
2018-02-09 14:13:57.577 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-02-09 14:13:57.583 -05:00 [DBG] Client validation success
2018-02-09 14:13:57.590 -05:00 [DBG] Start token request validation
2018-02-09 14:13:57.614 -05:00 [DBG] Start client credentials token request validation
2018-02-09 14:13:57.690 -05:00 [DBG] Found [] identity scopes in database
2018-02-09 14:13:57.993 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:58.066 -05:00 [DBG] Found [] identity scopes in database
2018-02-09 14:13:58.356 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:13:58.367 -05:00 [DBG] mvc credentials token request validation success
2018-02-09 14:13:58.374 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "GrantType": "client_credentials",
  "Scopes": "api1.APIScope",
  "Raw": {
    "grant_type": "client_credentials",
    "scope": "api1.APIScope"
  }
}
2018-02-09 14:13:58.392 -05:00 [DBG] Getting claims for access token for client: mvc
2018-02-09 14:13:58.404 -05:00 [DBG] Token request success.
2018-02-09 14:14:04.333 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:14:04.354 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:14:04.365 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-09 14:14:04.378 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-09 14:14:04.386 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-09 14:14:04.410 -05:00 [DBG] Processing signout request for 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:14:04.433 -05:00 [DBG] Start end session request validation
2018-02-09 14:14:04.454 -05:00 [DBG] Start identity token validation
2018-02-09 14:14:05.028 -05:00 [DBG] mvc found in database: true
2018-02-09 14:14:05.035 -05:00 [DBG] Client found: mvc / mvc.client
2018-02-09 14:14:05.116 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 14:14:05.126 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1518203615,
    "exp": 1518203915,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636538003682779179.ODA4MmY3MDctYmE4Zi00NWY4LTk0MmEtNWZmMDZiOTdkMWEyZjU2NjViMGEtOTM2Yy00ZmYyLWExNjEtNjZmYWNiMTU1ZDFm",
    "iat": 1518203615,
    "at_hash": "l2SF4-QjHaKuQNEXwu7Lxg",
    "sid": "1d6041be80178d5e08717d748507a54d",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518203606,
    "idp": "local",
    "preferred_username": "prdiet",
    "name": "prdiet",
    "amr": "pwd"
  }
}
2018-02-09 14:14:05.146 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "mvc.client",
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8O7BMrsJqQNKq-OZZwepkQ2qEA49mbJuh6b0ABdfYXv0bLDGdGybfwc5HTLcREXUIWi5zUn3yhX10LrwHZmouTT2-yxyj6wCxrfAksxZ6XuNg7r-CSa4kDrA_Tb9hb_DScdkiwV565e639GEb1M4YPEFF7znmtPogfwNa1CBg-vu",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjY3NTYzMGI1NWQ3NWE3OTI4MmNmZWI2OGNiN2I2MDZmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTgyMDM2MTUsImV4cCI6MTUxODIwMzkxNSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1MzgwMDM2ODI3NzkxNzkuT0RBNE1tWTNNRGN0WW1FNFppMDBOV1k0TFRrME1tRXROV1ptTURaaU9UZGtNV0V5WmpVMk5qVmlNR0V0T1RNMll5MDBabVl5TFdFeE5qRXROalptWVdOaU1UVTFaREZtIiwiaWF0IjoxNTE4MjAzNjE1LCJhdF9oYXNoIjoibDJTRjQtUWpIYUt1UU5FWHd1N0x4ZyIsInNpZCI6IjFkNjA0MWJlODAxNzhkNWUwODcxN2Q3NDg1MDdhNTRkIiwic3ViIjoiOGFlMjRhMjgtNTlmNS00OGE2LTkyYzYtYzZjYWM1NTEzNDFiIiwiYXV0aF90aW1lIjoxNTE4MjAzNjA2LCJpZHAiOiJsb2NhbCIsInByZWZlcnJlZF91c2VybmFtZSI6InByZGlldCIsIm5hbWUiOiJwcmRpZXQiLCJhbXIiOlsicHdkIl19.ZRbjbnnBJtmHv_JimyGFBq9iRH9hpWTAuFbAhIySc9lW3eSuuty7dIVMgsW2om-Cpi0mfJ3uAEYUSByj9qqwgSUXKv2GLH8FxGUXzOzZ4fGI1v9jRUeyZ0w_878iCIafKZDIiUV3vrGevoc2d7cgOAAHWLG9KLU9eN2P1Dl_FYkB7irTKhgPu3wEo-zI4KHSyWjHMqDyTr2jLh6TLK7XQ0CmHIPLTbld8bSxKgVy51y3KP3Bh-lJIySv17rYYUAQIwK7KvXKfYMIg33zG3PEs-kXzLSaCei0M3vB4hJisyjUKMMZYGku41jDxSJQ7jNN6lETOBfKBzxLAAzhKYLMpg",
    "state": "CfDJ8O7BMrsJqQNKq-OZZwepkQ2qEA49mbJuh6b0ABdfYXv0bLDGdGybfwc5HTLcREXUIWi5zUn3yhX10LrwHZmouTT2-yxyj6wCxrfAksxZ6XuNg7r-CSa4kDrA_Tb9hb_DScdkiwV565e639GEb1M4YPEFF7znmtPogfwNa1CBg-vu",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-02-09 14:14:05.168 -05:00 [DBG] Success validating end session request from mvc
2018-02-09 14:14:05.235 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:14:05.246 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:14:05.464 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-02-09 14:14:05.474 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 14:14:05.485 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-02-09 14:14:05.497 -05:00 [INF] User logged out.
2018-02-09 14:14:05.954 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-09 14:14:05.970 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-09 14:14:05.977 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-09 14:14:05.998 -05:00 [DBG] Processing signout callback request
2018-02-09 14:14:06.640 -05:00 [DBG] mvc found in database: true
2018-02-09 14:14:06.648 -05:00 [DBG] Client front-channel logout URLs: http://localhost:5002/signout-oidc?sid=1d6041be80178d5e08717d748507a54d&iss=http%3A%2F%2Flocalhost%3A5000
2018-02-09 14:14:06.656 -05:00 [DBG] No client back-channel logout URLs
2018-02-09 14:14:06.661 -05:00 [INF] Successful signout callback.
2018-02-09 14:14:06.672 -05:00 [DBG] Client front-channel iframe urls: ["http://localhost:5002/signout-oidc?sid=1d6041be80178d5e08717d748507a54d&iss=http%3A%2F%2Flocalhost%3A5000"]
2018-02-09 14:14:06.678 -05:00 [DBG] No client back-channel iframe urls
2018-02-09 14:15:50.763 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-09 14:15:50.854 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-09 14:15:50.859 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-09 14:15:50.863 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-09 14:15:50.867 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-09 14:17:18.827 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:17:20.110 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:17:20.125 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:17:20.289 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:17:20.341 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:17:20.347 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:17:20.365 -05:00 [DBG] Start discovery request
2018-02-09 14:17:22.170 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:17:22.456 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-09 14:17:22.569 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-09 14:17:22.576 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-09 14:17:22.595 -05:00 [DBG] Start authorize request
2018-02-09 14:17:22.633 -05:00 [DBG] No user present in authorize request
2018-02-09 14:17:22.665 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:17:24.036 -05:00 [DBG] js found in database: true
2018-02-09 14:17:24.282 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:17:24.736 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:17:24.895 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:17:25.225 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:17:25.258 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:17:25.330 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "0aa761d555a247469fe4cfbe3f981b46",
  "Nonce": "233614a0659f4797bdccf4783de5c187",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "0aa761d555a247469fe4cfbe3f981b46",
    "nonce": "233614a0659f4797bdccf4783de5c187"
  }
}
2018-02-09 14:17:25.362 -05:00 [INF] Showing login: User is not authenticated
2018-02-09 14:17:26.047 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 14:17:26.083 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:17:26.926 -05:00 [DBG] js found in database: true
2018-02-09 14:17:27.111 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:17:27.541 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:17:27.738 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:17:28.143 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:17:28.154 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:18:01.664 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:18:01.674 -05:00 [DBG] Adding idp claim with value: local
2018-02-09 14:18:01.679 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-09 14:18:01.685 -05:00 [DBG] Adding auth_time claim with value: 1518203881
2018-02-09 14:18:01.713 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:18:01.726 -05:00 [INF] User logged in.
2018-02-09 14:18:01.793 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:01.803 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:01.813 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-09 14:18:01.821 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-09 14:18:01.826 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-09 14:18:01.850 -05:00 [DBG] Start authorize callback request
2018-02-09 14:18:01.864 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:18:01.868 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:18:03.171 -05:00 [DBG] js found in database: true
2018-02-09 14:18:03.438 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:18:04.080 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:18:04.329 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:18:04.999 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:18:05.011 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:18:05.021 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "0aa761d555a247469fe4cfbe3f981b46",
  "Nonce": "233614a0659f4797bdccf4783de5c187",
  "SessionId": "cd0b28a8e8d9751c79dfd5bd98a0d4d4",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "0aa761d555a247469fe4cfbe3f981b46",
    "nonce": "233614a0659f4797bdccf4783de5c187"
  }
}
2018-02-09 14:18:05.263 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-09 14:18:05.284 -05:00 [DBG] Creating Implicit Flow response.
2018-02-09 14:18:05.317 -05:00 [DBG] Getting claims for access token for client: js
2018-02-09 14:18:05.323 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:18:05.714 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-09 14:18:05.720 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-09 14:18:05.769 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "0aa761d555a247469fe4cfbe3f981b46",
  "Scope": "openid profile api1"
}
2018-02-09 14:18:05.815 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:18:05.820 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:18:06.276 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:18:06.353 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:18:06.365 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:18:06.383 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:18:06.392 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:18:06.403 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:18:06.417 -05:00 [DBG] Start discovery request
2018-02-09 14:18:06.858 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:18:06.888 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-09 14:18:06.951 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:18:06.961 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:18:06.976 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:18:06.986 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:18:06.993 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:18:07.009 -05:00 [DBG] Start key discovery request
2018-02-09 14:18:07.117 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 14:18:07.187 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:18:07.195 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:18:07.231 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 14:18:07.290 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:18:07.297 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:18:07.312 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-09 14:18:07.328 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-09 14:18:07.334 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-09 14:18:07.360 -05:00 [DBG] Start userinfo request
2018-02-09 14:18:07.374 -05:00 [DBG] Bearer token found in header
2018-02-09 14:18:08.195 -05:00 [DBG] js found in database: true
2018-02-09 14:18:08.812 -05:00 [DBG] js found in database: true
2018-02-09 14:18:08.916 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 14:18:08.939 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518203885,
    "exp": 1518207485,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518203881,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-09 14:18:08.968 -05:00 [DBG] Creating userinfo response
2018-02-09 14:18:08.982 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:18:08.995 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:18:09.189 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:18:09.199 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-09 14:18:09.204 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:18:09.388 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:18:09.576 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-09 14:18:09.586 -05:00 [DBG] End userinfo request
2018-02-09 14:18:09.630 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:09.646 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:09.672 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 14:18:09.681 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 14:18:09.687 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 14:18:09.703 -05:00 [DBG] Rendering check session result
2018-02-09 14:18:10.030 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:18:10.102 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:18:10.110 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:18:10.124 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:18:10.131 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:18:10.138 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:18:10.148 -05:00 [DBG] Start discovery request
2018-02-09 14:18:10.573 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:18:10.605 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:10.615 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:18:10.625 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 14:18:10.631 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 14:18:10.637 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 14:18:10.648 -05:00 [DBG] Rendering check session result
2018-02-09 14:18:14.018 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:18:14.024 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:18:14.032 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:18:14.041 -05:00 [DBG] Start discovery request
2018-02-09 14:18:14.457 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:18:15.000 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:18:15.007 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:18:15.016 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:18:15.026 -05:00 [DBG] Start key discovery request
2018-02-09 14:48:26.223 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2018-02-09 14:48:26.308 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2018-02-09 14:48:26.313 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2018-02-09 14:48:26.317 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2018-02-09 14:48:26.340 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2018-02-09 14:50:17.060 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:50:18.409 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:18.429 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:18.588 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:50:18.637 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:50:18.644 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:50:18.664 -05:00 [DBG] Start discovery request
2018-02-09 14:50:20.380 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:50:20.710 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-09 14:50:20.799 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-09 14:50:20.806 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-09 14:50:20.826 -05:00 [DBG] Start authorize request
2018-02-09 14:50:20.859 -05:00 [DBG] No user present in authorize request
2018-02-09 14:50:20.892 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:50:22.279 -05:00 [DBG] js found in database: true
2018-02-09 14:50:22.525 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:22.973 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:23.164 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:23.475 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:23.515 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:50:23.587 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "4d85185915de4a0abfaece08e5199861",
  "Nonce": "c6f1ff10d2af4f95904af564b628567f",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "4d85185915de4a0abfaece08e5199861",
    "nonce": "c6f1ff10d2af4f95904af564b628567f"
  }
}
2018-02-09 14:50:23.620 -05:00 [INF] Showing login: User is not authenticated
2018-02-09 14:50:24.354 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 14:50:24.401 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:50:25.344 -05:00 [DBG] js found in database: true
2018-02-09 14:50:25.507 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:25.924 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:26.074 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:26.494 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:26.506 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:50:52.106 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:50:52.115 -05:00 [DBG] Adding idp claim with value: local
2018-02-09 14:50:52.119 -05:00 [DBG] Adding amr claim with value: pwd
2018-02-09 14:50:52.125 -05:00 [DBG] Adding auth_time claim with value: 1518205852
2018-02-09 14:50:52.153 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:50:52.168 -05:00 [INF] User logged in.
2018-02-09 14:50:52.249 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:50:52.258 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:50:52.268 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-09 14:50:52.275 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-09 14:50:52.280 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-09 14:50:52.301 -05:00 [DBG] Start authorize callback request
2018-02-09 14:50:52.315 -05:00 [DBG] User in authorize request: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:50:52.320 -05:00 [DBG] Start authorize request protocol validation
2018-02-09 14:50:53.490 -05:00 [DBG] js found in database: true
2018-02-09 14:50:53.731 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:54.293 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:54.521 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:55.094 -05:00 [DBG] Found ["admin","user","api1.APIScope","api1"] API scopes in database
2018-02-09 14:50:55.105 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-09 14:50:55.112 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "js",
  "ClientName": "js.client",
  "RedirectUri": "http://localhost:5003/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5003/callback.html"
  ],
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "4d85185915de4a0abfaece08e5199861",
  "Nonce": "c6f1ff10d2af4f95904af564b628567f",
  "SessionId": "b9575fbc8364c825a4d62644f098c849",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5003/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "4d85185915de4a0abfaece08e5199861",
    "nonce": "c6f1ff10d2af4f95904af564b628567f"
  }
}
2018-02-09 14:50:55.331 -05:00 [DBG] Client is configured to not require consent, no consent is required
2018-02-09 14:50:55.349 -05:00 [DBG] Creating Implicit Flow response.
2018-02-09 14:50:55.374 -05:00 [DBG] Getting claims for access token for client: js
2018-02-09 14:50:55.379 -05:00 [DBG] Getting claims for access token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:50:55.779 -05:00 [DBG] Getting claims for identity token for subject: 8ae24a28-59f5-48a6-92c6-c6cac551341b and client: js
2018-02-09 14:50:55.786 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-02-09 14:50:55.826 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "ClientId": "js",
  "RedirectUri": "http://localhost:5003/callback.html",
  "State": "4d85185915de4a0abfaece08e5199861",
  "Scope": "openid profile api1"
}
2018-02-09 14:50:55.879 -05:00 [DBG] Augmenting SignInContext
2018-02-09 14:50:55.885 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-02-09 14:50:56.242 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:50:56.320 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:56.328 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:56.348 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:50:56.355 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:50:56.362 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:50:56.374 -05:00 [DBG] Start discovery request
2018-02-09 14:50:56.776 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:50:56.805 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5003
2018-02-09 14:50:56.859 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:56.865 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:56.878 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:50:56.887 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:50:56.894 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:50:56.920 -05:00 [DBG] Start key discovery request
2018-02-09 14:50:57.001 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 14:50:57.056 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:57.063 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:57.100 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5003
2018-02-09 14:50:57.160 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:57.166 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:57.178 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-02-09 14:50:57.190 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-02-09 14:50:57.196 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-02-09 14:50:57.218 -05:00 [DBG] Start userinfo request
2018-02-09 14:50:57.230 -05:00 [DBG] Bearer token found in header
2018-02-09 14:50:57.920 -05:00 [DBG] js found in database: true
2018-02-09 14:50:58.476 -05:00 [DBG] js found in database: true
2018-02-09 14:50:58.556 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 14:50:58.574 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1518205855,
    "exp": 1518209455,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "js",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518205852,
    "idp": "local",
    "name": "prdiet",
    "email": "Paul.Dietz@roush.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-02-09 14:50:58.598 -05:00 [DBG] Creating userinfo response
2018-02-09 14:50:58.612 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:50:58.621 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:50:58.733 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:58.742 -05:00 [DBG] Requested claim types: sub zoneinfo birthdate gender website picture profile locale preferred_username middle_name given_name family_name name nickname updated_at
2018-02-09 14:50:58.747 -05:00 [DBG] Scopes in access token: openid profile api1
2018-02-09 14:50:58.844 -05:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-09 14:50:58.976 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-02-09 14:50:58.986 -05:00 [DBG] End userinfo request
2018-02-09 14:50:59.028 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:50:59.046 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:50:59.058 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 14:50:59.066 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 14:50:59.079 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 14:50:59.099 -05:00 [DBG] Rendering check session result
2018-02-09 14:50:59.464 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5003
2018-02-09 14:50:59.543 -05:00 [DBG] Origin http://localhost:5003 is allowed: true
2018-02-09 14:50:59.551 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:5003
2018-02-09 14:50:59.565 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:50:59.572 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:50:59.579 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:50:59.588 -05:00 [DBG] Start discovery request
2018-02-09 14:50:59.992 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:51:00.039 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:00.056 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:00.070 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-02-09 14:51:00.077 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-02-09 14:51:00.085 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-02-09 14:51:00.095 -05:00 [DBG] Rendering check session result
2018-02-09 14:51:06.186 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-09 14:51:06.193 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-09 14:51:06.202 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-09 14:51:06.210 -05:00 [DBG] Start discovery request
2018-02-09 14:51:06.603 -05:00 [DBG] Found ["openid","email","profile","api1.IdentityScope","admin","user","api1.APIScope","api1"] as all scopes in database
2018-02-09 14:51:07.113 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-09 14:51:07.118 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-09 14:51:07.127 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-09 14:51:07.136 -05:00 [DBG] Start key discovery request
2018-02-09 14:51:13.166 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:13.179 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:13.189 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-09 14:51:13.199 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-09 14:51:13.204 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-09 14:51:13.227 -05:00 [DBG] Processing signout request for 8ae24a28-59f5-48a6-92c6-c6cac551341b
2018-02-09 14:51:13.248 -05:00 [DBG] Start end session request validation
2018-02-09 14:51:13.265 -05:00 [DBG] Start identity token validation
2018-02-09 14:51:13.818 -05:00 [DBG] js found in database: true
2018-02-09 14:51:13.826 -05:00 [DBG] Client found: js / js.client
2018-02-09 14:51:13.908 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-02-09 14:51:13.916 -05:00 [DBG] Token validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1518205855,
    "exp": 1518206155,
    "iss": "http://localhost:5000",
    "aud": "js",
    "nonce": "c6f1ff10d2af4f95904af564b628567f",
    "iat": 1518205855,
    "at_hash": "OsVRChTVO5YQGlkekXXhhg",
    "sid": "b9575fbc8364c825a4d62644f098c849",
    "sub": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
    "auth_time": 1518205852,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-02-09 14:51:13.946 -05:00 [INF] End session request validation success
{
  "ClientId": "js",
  "ClientName": "js.client",
  "SubjectId": "8ae24a28-59f5-48a6-92c6-c6cac551341b",
  "PostLogOutUri": "http://localhost:5003/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjY3NTYzMGI1NWQ3NWE3OTI4MmNmZWI2OGNiN2I2MDZmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTgyMDU4NTUsImV4cCI6MTUxODIwNjE1NSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoianMiLCJub25jZSI6ImM2ZjFmZjEwZDJhZjRmOTU5MDRhZjU2NGI2Mjg1NjdmIiwiaWF0IjoxNTE4MjA1ODU1LCJhdF9oYXNoIjoiT3NWUkNoVFZPNVlRR2xrZWtYWGhoZyIsInNpZCI6ImI5NTc1ZmJjODM2NGM4MjVhNGQ2MjY0NGYwOThjODQ5Iiwic3ViIjoiOGFlMjRhMjgtNTlmNS00OGE2LTkyYzYtYzZjYWM1NTEzNDFiIiwiYXV0aF90aW1lIjoxNTE4MjA1ODUyLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.LvzEcwsjLiIc15D8nqcKqDjlSn-OcmyB16exsN-iWQunhZGpL-gTTJF6FfVVlzRum7zZPeBHlZZ-gmm20YXk97M8J8lj3hD4MJY4hLG0ED99OfNjYwX2sMunkzTAyFLeltdC8OxZm6GHk3z4iRzJhyrJhgjkQHpmZj6XHbbgzOT0LG7gBX1xfTy52LoknrffEmjTG-dNOlEJfVzQC7uliUfRubfvgBFh-zrN-3cLXOTHFCm2DPzzRutoK1CgaT9hDV0KcdrOlyOiijJVIVhr_HxSBv7MI_y018bR5BH6w7GSNQ4X1FvJu1baSNXb99fiEzIiNkkR5v350I_vQoFHdg",
    "post_logout_redirect_uri": "http://localhost:5003/index.html"
  }
}
2018-02-09 14:51:13.963 -05:00 [DBG] Success validating end session request from js
2018-02-09 14:51:14.023 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:14.034 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-02-09 14:51:14.216 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-02-09 14:51:14.225 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-02-09 14:51:14.235 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-02-09 14:51:14.243 -05:00 [INF] User logged out.
2018-02-09 14:51:14.719 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-09 14:51:14.732 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-09 14:51:14.738 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-09 14:51:14.760 -05:00 [DBG] Processing signout callback request
2018-02-09 14:51:15.391 -05:00 [DBG] js found in database: true
2018-02-09 14:51:15.401 -05:00 [DBG] No client front-channel logout URLs
2018-02-09 14:51:15.405 -05:00 [DBG] No client back-channel logout URLs
2018-02-09 14:51:15.410 -05:00 [INF] Successful signout callback.
2018-02-09 14:51:15.418 -05:00 [DBG] No client front-channel iframe urls
2018-02-09 14:51:15.423 -05:00 [DBG] No client back-channel iframe urls
